<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        form button:hover {
            background-color: #218838;
        }
        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        table thead {
            background-color: #007bff;
            color: white;
        }
        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        table tr:hover {
            background-color: #f1f1f1;
        }
        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .edit-button {
            background-color: #ffc107;
            color: white;
        }
        .edit-button:hover {
            background-color: #e0a800;
        }
        .delete-button {
            background-color: #dc3545;
            color: white;
        }
        .delete-button:hover {
            background-color: #c82333;
        }
        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }
        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Input Data</h1>
    <form id="dataForm">
        <label for="division">Divisi:</label>
        <select id="division" name="division" required onchange="updateForm()">
            <option value="">-- Pilih Divisi --</option>
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <div id="commonFields">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date">
            <label for="itemName">Nama Barang:</label>
            <div id="itemNameContainer">
                <select id="itemNameSelect" name="itemName"></select>
                <input type="text" id="itemNameInput" name="itemName" style="display: none;">
            </div>
            <label for="type">Jenis:</label>
            <select id="type" name="type">
                <option value="Material Masuk">Material Masuk</option>
                <option value="Material Terpakai">Material Terpakai</option>
                <option value="Material Reject">Material Reject</option>
                <option value="Potongan Reject">Potongan Reject</option>
            </select>
            <label for="quantity">Banyaknya:</label>
            <input type="number" id="quantity" name="quantity">
            <label for="notes">Catatan:</label>
            <input type="text" id="notes" name="notes">
        </div>
        <div id="dailyJobFields" style="display: none;">
            <label for="activity">Kegiatan:</label>
            <input type="text" id="activity" name="activity">
            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate">
            <label for="targetDate">Target Date:</label>
            <input type="date" id="targetDate" name="targetDate">
            <label for="finishDate">Finish Date:</label>
            <input type="date" id="finishDate" name="finishDate">
            <label for="progressNotes">Catatan Progress:</label>
            <input type="text" id="progressNotes" name="progressNotes">
        </div>
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Preview</h2>
    <div id="preview">
        <table>
            <thead id="tableHead"></thead>
            <tbody></tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script>
        const data = [];

        function updateForm() {
            const division = document.getElementById('division').value;
            const commonFields = document.getElementById('commonFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');

            if (division === 'DAILY JOB') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'block';
                itemNameInput.required = false;
                itemNameSelect.required = false;
            } else {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                updateItemNames();
            }

            updateTableHeader();
        }

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');
            
            if (division === 'DAILY JOB') {
                itemNameSelect.style.display = 'none';
                itemNameInput.style.display = 'block';
            } else {
                itemNameSelect.style.display = 'block';
                itemNameInput.style.display = 'none';
                itemNameSelect.innerHTML = '<option value="">-- Pilih Nama Barang --</option>';
                let items = [];
                if (division === 'INDOOR') {
                    items = ['DOKU TONER BLACK', 'DOKU TONER CYAN', 'DOKU TONER MAGENTA', 'DOKU TONER YELLOW', 'KERTAS ARTCARTON / BW A3+', 'KERTAS ARTPAPER A3+', 'KERTAS BRIEF CARD / BC F4', 'KERTAS BUFALO BIRU', 'KERTAS BUFALO HIJAU', 'KERTAS BUFALO KUNING', 'KERTAS BUFALO MERAH', 'KERTAS BUFALO ORANGE', 'KERTAS BUFALO PINK', 'KERTAS BUFALO PUTIH', 'KERTAS BUFALO SKY BLUE', 'KERTAS BUFALO UNGU', 'KERTAS FOTO', 'KERTAS HVS A3 PUTIH', 'KERTAS HVS A3+ PUTIH', 'KERTAS HVS A4 PUTIH', 'KERTAS HVS F4 BIRU', 'KERTAS HVS F4 HIJAU', 'KERTAS HVS F4 KUNING', 'KERTAS HVS F4 MERAH', 'KERTAS HVS F4 PUTIH', 'KERTAS INJECT', 'KERTAS KALKIR', 'KERTAS SULAP / BRISTOL', 'KERTAS TRANSFER', 'KERTAS WASTE', 'KERTAS KERJA', 'KERTAS FTO A3', 'KERTAS FTO A4'];
                } else if (division === 'OUTDOOR') {
                    items = ['BANNER FLEXIE', 'BANNER CANVAS', 'BANNER JONGLONG', 'BANNER NON WOVEN', 'BANNER TARPOLINE', 'BANNER TRON', 'BANNER VINYL', 'BANNER STICKER', 'BANNER STICKER LASER', 'BANNER STICKER LASER EXPO', 'BANNER STICKER LASER OPP', 'BANNER STICKER LASER SINAR'];
                }
                items.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.textContent = item;
                    itemNameSelect.appendChild(option);
                });
            }
        }

        function updateTableHeader() {
            const division = document.getElementById('division').value;
            const tableHead = document.getElementById('tableHead');
            tableHead.innerHTML = '';

            if (division === 'ORDER PERMINTAAN BARANG') {
                tableHead.innerHTML = `
                    <tr>
                        <th>Divisi</th>
                        <th>Date</th>
                        <th>Nama Barang</th>
                        <th>Banyaknya</th>
                        <th>Status Proses</th>
                        <th>Action</th>
                    </tr>
                `;
            } else if (division === 'DAILY JOB') {
                tableHead.innerHTML = `
                    <tr>
                        <th>Division</th>
                        <th>Date</th>
                        <th>Activity</th>
                        <th>Start Date</th>
                        <th>Target Date</th>
                        <th>Finish Date</th>
                        <th>Progress Notes</th>
                        <th>Action</th>
                    </tr>
                `;
            } else {
                tableHead.innerHTML = `
                    <tr>
                        <th>Division</th>
                        <th>Date</th>
                        <th>Item Name</th>
                        <th>Type</th>
                        <th>Quantity</th>
                        <th>Notes</th>
                        <th>Action</th>
                    </tr>
                `;
            }
        }

        function addData() {
            const division = document.getElementById('division').value;
            const date = document.getElementById('date').value;
            const itemName = division === 'DAILY JOB' ? document.getElementById('activity').value : document.getElementById('itemNameSelect').value || document.getElementById('itemNameInput').value;
            const type = document.getElementById('type') ? document.getElementById('type').value : '';
            const quantity = document.getElementById('quantity') ? document.getElementById('quantity').value : '';
            const notes = document.getElementById('notes') ? document.getElementById('notes').value : '';
            const startDate = document.getElementById('startDate') ? document.getElementById('startDate').value : '';
            const targetDate = document.getElementById('targetDate') ? document.getElementById('targetDate').value : '';
            const finishDate = document.getElementById('finishDate') ? document.getElementById('finishDate').value : '';
            const progressNotes = document.getElementById('progressNotes') ? document.getElementById('progressNotes').value : '';

            if (!date || (division !== 'DAILY JOB' && !itemName) || (division === 'DAILY JOB' && !itemName)) {
                alert('Please fill all required fields.');
                return;
            }

            const row = {
                division,
                date,
                itemName,
                type,
                quantity,
                notes,
                startDate,
                targetDate,
                finishDate,
                progressNotes
            };
            data.push(row);
            renderTable();
            document.getElementById('dataForm').reset();
        }

        function renderTable() {
            const tbody = document.querySelector('tbody');
            tbody.innerHTML = '';
            data.forEach((item, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${item.division}</td>
                    <td>${item.date}</td>
                    <td>${item.itemName}</td>
                    <td>${item.type || ''}</td>
                    <td>${item.quantity || ''}</td>
                    <td>${item.notes || ''}</td>
                    <td>${item.startDate || ''}</td>
                    <td>${item.targetDate || ''}</td>
                    <td>${item.finishDate || ''}</td>
                    <td>${item.progressNotes || ''}</td>
                    <td class="action-buttons">
                        <button class="edit-button" onclick="editRow(${index})">Edit</button>
                        <button class="delete-button" onclick="deleteRow(${index})">Delete</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function editRow(index) {
            const item = data[index];
            document.getElementById('division').value = item.division;
            document.getElementById('date').value = item.date;
            if (item.division === 'DAILY JOB') {
                document.getElementById('activity').value = item.itemName;
                document.getElementById('startDate').value = item.startDate;
                document.getElementById('targetDate').value = item.targetDate;
                document.getElementById('finishDate').value = item.finishDate;
                document.getElementById('progressNotes').value = item.progressNotes;
            } else {
                document.getElementById('itemNameSelect').value = item.itemName;
                document.getElementById('itemNameInput').value = item.itemName;
                document.getElementById('type').value = item.type;
                document.getElementById('quantity').value = item.quantity;
                document.getElementById('notes').value = item.notes;
            }
            data.splice(index, 1);
            renderTable();
        }

        function deleteRow(index) {
            data.splice(index, 1);
            renderTable();
        }

        function saveToExcel() {
            // Implementation for saving data to Excel
        }

        // Initial table header update
        updateTableHeader();
    </script>
</body>
</html>
