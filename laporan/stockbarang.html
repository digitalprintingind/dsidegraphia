<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        form button:hover {
            background-color: #218838;
        }

        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table thead {
            background-color: #007bff;
            color: white;
        }

        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-button {
            background-color: #ffc107;
            color: white;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: white;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>LAPORAN STOCK BARANG</h1>
    <form id="dataForm">
        <label for="division">Pilih Laporan:</label>
        <select id="division" name="division" required onchange="updateForm()">
            <option value="">-- Pilih Divisi --</option>
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <div id="commonFields">
            <label for="date">Tanggal:</label>
            <input type="date" id="date" name="date">
            <label for="itemName">Nama Barang:</label>
            <div id="itemNameContainer">
                <select id="itemNameSelect" name="itemName">
                    <!-- Options will be populated based on division selection -->
                </select>
                <input type="text" id="itemNameInput" name="itemName" style="display: none;">
            </div>
            <label for="type">Jenis:</label>
            <select id="type" name="type">
                <option value="Material Masuk">Material Masuk</option>
                <option value="Material Terpakai">Material Terpakai</option>
                <option value="Material Reject">Material Reject</option>
                <option value="Potongan Reject">Potongan Reject</option>
            </select>
            <label for="quantity">Banyaknya:</label>
            <input type="number" id="quantity" name="quantity">
            <label for="notes">Catatan:</label>
            <input type="text" id="notes" name="notes">
        </div>
        <div id="dailyJobFields" style="display: none;">
            <label for="activity">Kegiatan:</label>
            <input type="text" id="activity" name="activity">
            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate">
            <label for="targetDate">Target Date:</label>
            <input type="date" id="targetDate" name="targetDate">
            <label for="finishDate">Finish Date:</label>
            <input type="date" id="finishDate" name="finishDate">
            <label for="progressNotes">Catatan Progress:</label>
            <input type="text" id="progressNotes" name="progressNotes">
        </div>
        <div id="orderPermintaanBarangFields" style="display: none;">
            <label for="opbItemName">Nama Barang:</label>
            <input type="text" id="opbItemName" name="opbItemName">
            <label for="opbDate">Tanggal:</label>
            <input type="date" id="opbDate" name="opbDate">
            <label for="opbQuantity">Banyaknya:</label>
            <input type="number" id="opbQuantity" name="opbQuantity">
            <label for="opbStatus">Status Proses:</label>
            <select id="opbStatus" name="opbStatus">
                <option value="Diajukan">Diajukan</option>
                <option value="Diproses">Diproses</option>
                <option value="Selesai">Selesai</option>
            </select>
        </div>
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Tampilan Tabel Data</h2>
    <div id="preview">
        <table>
            <thead id="tableHead">
                <!-- Table headers will be populated based on division selection -->
            </thead>
            <tbody id="tableBody">
                <!-- Table rows will be populated dynamically -->
            </tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script>
        const data = [];

        function updateForm() {
            const division = document.getElementById('division').value;
            const commonFields = document.getElementById('commonFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const orderPermintaanBarangFields = document.getElementById('orderPermintaanBarangFields');
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');

            if (division === 'DAILY JOB') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'block';
                orderPermintaanBarangFields.style.display = 'none';
                itemNameInput.required = false;
                itemNameSelect.required = false;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'none';
                orderPermintaanBarangFields.style.display = 'block';
            } else {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                orderPermintaanBarangFields.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                updateItemNames();
            }

            updateTableHeader();
        }

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');

            if (division === 'DAILY JOB' || division === 'ORDER PERMINTAAN BARANG') {
                itemNameSelect.style.display = 'none';
                itemNameInput.style.display = 'block';
            } else {
                itemNameSelect.style.display = 'block';
                itemNameInput.style.display = 'none';

                let items = [];
                if (division === 'INDOOR') {
                    items = ['KERTAS ART CARTON 210 GR', 'KERTAS ART CARTON 230 GR', 'KERTAS ART CARTON 260 GR', 'KERTAS ART CARTON 310 GR', 'KERTAS ART PAPER 100 GR', 'KERTAS ART PAPER 120 GR', 'KERTAS BLUES WHITE 80 GR', 'KERTAS CORRUGATED', 'KERTAS HVS 70 GR', 'KERTAS HVS 80 GR', 'KERTAS HVS F4 PUTIH', 'KERTAS MATT PAPER A3+', 'KERTAS SAMSON 70 GR', 'LAMINASI DINGIN KILAP 310', 'LAMINASI DINGIN KILAP 43', 'LAMINASI DINGIN KILAP 60', 'LAMINASI DINGIN KILAP 90', 'LAMINASI DINGIN KILAP 125', 'LAMINASI DINGIN LUSTRE 31', 'LAMINASI DINGIN LUSTRE 43', 'LAMINASI DINGIN LUSTRE 60', 'LAMINASI DINGIN LUSTRE 90', 'LAMINASI DINGIN LUSTRE 125', 'LAMINASI DINGIN LUSTRE 310', 'LAMINASI PANAS GLOSSY 250', 'LAMINASI PANAS MATT 250', 'STIKER COKLAT A3+', 'STIKER DOFF A3+', 'STIKER GLOSSY A3+'];
                } else if (division === 'OUTDOOR') {
                    items = ['FLEXI CINA 340 GR', 'FLEXI JERMAN 340 GR', 'FLEXI KOREA 440 GR', 'LAMINASI FLOOR', 'LAMINASI GLOSSY', 'LAMINASI STICKER', 'LAMINASI UV', 'MESH', 'ONEWAY VISION', 'STIKER CINA', 'STIKER ORACAL'];
                } else if (division === 'PRODUKSI') {
                    items = ['AVERY DANNISON', 'FLEXI CINA 340 GR', 'FLEXI CINA 440 GR', 'FLEXI JERMAN 440 GR', 'FLEXI KOREA 440 GR', 'LAMINASI DINGIN', 'LAMINASI PANAS', 'MESH', 'ONWAY VISION', 'STIKER ORACAL'];
                } else if (division === 'GUDANG') {
                    items = ['BANNER', 'FLEXI CINA', 'FLEXI JERMAN', 'FLEXI KOREA', 'LAMINASI DINGIN', 'LAMINASI PANAS', 'MESH', 'ONWAY VISION', 'STIKER CINA', 'STIKER ORACAL'];
                } else if (division === 'PURCHASE ORDER') {
                    items = ['BANNER', 'FLEXI CINA', 'FLEXI JERMAN', 'FLEXI KOREA', 'LAMINASI DINGIN', 'LAMINASI PANAS', 'MESH', 'ONWAY VISION', 'STIKER CINA', 'STIKER ORACAL'];
                }

                items.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.text = item;
                    itemNameSelect.appendChild(option);
                });
            }
        }

        function updateTableHeader() {
            const division = document.getElementById('division').value;
            const tableHead = document.getElementById('tableHead');
            let headers = '';

            if (division === 'DAILY JOB') {
                headers = `
                    <tr>
                        <th>No</th>
                        <th>Tanggal</th>
                        <th>Kegiatan</th>
                        <th>Start Date</th>
                        <th>Target Date</th>
                        <th>Finish Date</th>
                        <th>Catatan Progress</th>
                        <th>Actions</th>
                    </tr>`;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                headers = `
                    <tr>
                        <th>No</th>
                        <th>Nama Barang</th>
                        <th>Tanggal</th>
                        <th>Banyaknya</th>
                        <th>Status Proses</th>
                        <th>Actions</th>
                    </tr>`;
            } else {
                headers = `
                    <tr>
                        <th>No</th>
                        <th>Tanggal</th>
                        <th>Nama Barang</th>
                        <th>Jenis</th>
                        <th>Banyaknya</th>
                        <th>Catatan</th>
                        <th>Actions</th>
                    </tr>`;
            }

            tableHead.innerHTML = headers;
        }

        function addData() {
            const division = document.getElementById('division').value;
            let row = {};

            if (division === 'DAILY JOB') {
                row = {
                    no: data.length + 1,
                    date: document.getElementById('date').value,
                    activity: document.getElementById('activity').value,
                    startDate: document.getElementById('startDate').value,
                    targetDate: document.getElementById('targetDate').value,
                    finishDate: document.getElementById('finishDate').value,
                    progressNotes: document.getElementById('progressNotes').value
                };
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                row = {
                    no: data.length + 1,
                    itemName: document.getElementById('opbItemName').value,
                    date: document.getElementById('opbDate').value,
                    quantity: document.getElementById('opbQuantity').value,
                    status: document.getElementById('opbStatus').value
                };
            } else {
                row = {
                    no: data.length + 1,
                    date: document.getElementById('date').value,
                    itemName: document.getElementById('itemNameSelect').value,
                    type: document.getElementById('type').value,
                    quantity: document.getElementById('quantity').value,
                    notes: document.getElementById('notes').value
                };
            }

            data.push(row);
            updateTable();
        }

        function updateTable() {
            const division = document.getElementById('division').value;
            const tableBody = document.getElementById('tableBody');
            let rows = '';

            data.forEach((row, index) => {
                if (division === 'DAILY JOB') {
                    rows += `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${row.date}</td>
                            <td>${row.activity}</td>
                            <td>${row.startDate}</td>
                            <td>${row.targetDate}</td>
                            <td>${row.finishDate}</td>
                            <td>${row.progressNotes}</td>
                            <td class="action-buttons">
                                <button class="edit-button" onclick="editData(${index})">Edit</button>
                                <button class="delete-button" onclick="deleteData(${index})">Delete</button>
                            </td>
                        </tr>`;
                } else if (division === 'ORDER PERMINTAAN BARANG') {
                    rows += `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${row.itemName}</td>
                            <td>${row.date}</td>
                            <td>${row.quantity}</td>
                            <td>${row.status}</td>
                            <td class="action-buttons">
                                <button class="edit-button" onclick="editData(${index})">Edit</button>
                                <button class="delete-button" onclick="deleteData(${index})">Delete</button>
                            </td>
                        </tr>`;
                } else {
                    rows += `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${row.date}</td>
                            <td>${row.itemName}</td>
                            <td>${row.type}</td>
                            <td>${row.quantity}</td>
                            <td>${row.notes}</td>
                            <td class="action-buttons">
                                <button class="edit-button" onclick="editData(${index})">Edit</button>
                                <button class="delete-button" onclick="deleteData(${index})">Delete</button>
                            </td>
                        </tr>`;
                }
            });

            tableBody.innerHTML = rows;
        }

        function editData(index) {
            const row = data[index];
            const division = document.getElementById('division').value;

            if (division === 'DAILY JOB') {
                document.getElementById('date').value = row.date;
                document.getElementById('activity').value = row.activity;
                document.getElementById('startDate').value = row.startDate;
                document.getElementById('targetDate').value = row.targetDate;
                document.getElementById('finishDate').value = row.finishDate;
                document.getElementById('progressNotes').value = row.progressNotes;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                document.getElementById('opbItemName').value = row.itemName;
                document.getElementById('opbDate').value = row.date;
                document.getElementById('opbQuantity').value = row.quantity;
                document.getElementById('opbStatus').value = row.status;
            } else {
                document.getElementById('date').value = row.date;
                document.getElementById('itemNameSelect').value = row.itemName;
                document.getElementById('type').value = row.type;
                document.getElementById('quantity').value = row.quantity;
                document.getElementById('notes').value = row.notes;
            }

            deleteData(index);
        }

        function deleteData(index) {
            data.splice(index, 1);
            updateTable();
        }

        function saveToExcel() {
            const table = document.querySelector('table');
            const wb = XLSX.utils.table_to_book(table, {sheet: 'Sheet1'});
            XLSX.writeFile(wb, 'data.xlsx');
        }

        document.addEventListener('DOMContentLoaded', function () {
            updateForm();
        });
    </script>
</body>
</html>
