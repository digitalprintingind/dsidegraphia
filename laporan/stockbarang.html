<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        form button:hover {
            background-color: #218838;
        }

        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table thead {
            background-color: #007bff;
            color: white;
        }

        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: #007bff;
            color: white;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-button {
            background-color: #ffc107;
            color: white;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: white;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Input Data</h1>
    <form id="dataForm">
        <label for="division">Divisi:</label>
        <select id="division" name="division" required onchange="updateForm()">
            <option value="">-- Pilih Divisi --</option>
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <div id="commonFields">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date">
            <label for="itemName">Nama Barang:</label>
            <div id="itemNameContainer">
                <select id="itemNameSelect" name="itemName">
                    <!-- Options will be populated based on division selection -->
                </select>
                <input type="text" id="itemNameInput" name="itemName" style="display: none;">
            </div>
            <label for="type">Jenis:</label>
            <select id="type" name="type">
                <option value="Material Masuk">Material Masuk</option>
                <option value="Material Terpakai">Material Terpakai</option>
                <option value="Material Reject">Material Reject</option>
                <option value="Potongan Reject">Potongan Reject</option>
            </select>
            <label for="quantity">Banyaknya:</label>
            <input type="number" id="quantity" name="quantity">
            <label for="notes">Catatan:</label>
            <input type="text" id="notes" name="notes">
        </div>
        <div id="dailyJobFields" style="display: none;">
            <label for="activity">Kegiatan:</label>
            <input type="text" id="activity" name="activity">
            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate">
            <label for="targetDate">Target Date:</label>
            <input type="date" id="targetDate" name="targetDate">
            <label for="finishDate">Finish Date:</label>
            <input type="date" id="finishDate" name="finishDate">
            <label for="progressNotes">Catatan Progress:</label>
            <input type="text" id="progressNotes" name="progressNotes">
        </div>
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Preview</h2>
    <div id="preview">
        <table>
            <thead id="tableHead">
                <!-- Table headers will be populated based on division selection -->
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <script>
        const data = [];

        function updateForm() {
            const division = document.getElementById('division').value;
            const commonFields = document.getElementById('commonFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');

            if (division === 'DAILY JOB') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'block';
                itemNameInput.required = false;
                itemNameSelect.required = false;
            } else {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                updateItemNames();
            }

            updateTableHeader();
        }

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');
            
            if (division === 'DAILY JOB') {
                itemNameSelect.style.display = 'none';
                itemNameInput.style.display = 'block';
            } else {
                itemNameSelect.style.display = 'block';
                itemNameInput.style.display = 'none';
                itemNameSelect.innerHTML = '<option value="">-- Pilih Nama Barang --</option>';
                let items = [];
                if (division === 'INDOOR') {
                    items = ['DOKU TONER BLACK', 'DOKU TONER CYAN', 'DOKU TONER MAGENTA', 'DOKU TONER YELLOW', 'KERTAS ARTCARTON / BW A3+', 'KERTAS ARTPAPER A3+', 'KERTAS BRIEF CARD / BC F4', 'KERTAS BUFALO BIRU', 'KERTAS BUFALO HIJAU', 'KERTAS BUFALO KUNING', 'KERTAS BUFALO MERAH', 'KERTAS BUFALO ORANGE', 'KERTAS BUFALO PINK', 'KERTAS BUFALO PUTIH', 'KERTAS BUFALO SKY BLUE', 'KERTAS BUFALO UNGU', 'KERTAS FOTO', 'KERTAS HVS A3 PUTIH', 'KERTAS HVS A4 PUTIH', 'KERTAS KRAFT BROWN', 'KERTAS MAP TINGGI', 'KERTAS MAP RING BINDER'];
                } else if (division === 'OUTDOOR') {
                    items = ['BANNER PVC 440', 'BANNER STICKER', 'BANNER STRETCH', 'BANNER TRANSFAR', 'CLOTH BANNER', 'GLOBE BANNER', 'MEJA TAMPILAN', 'ROLLUP BANNER', 'STICKER LOGO', 'STICKER PAPER', 'STICKER VINYL', 'X-BANNER'];
                }
                items.forEach(item => {
                    itemNameSelect.innerHTML += `<option value="${item}">${item}</option>`;
                });
            }
        }

        function updateTableHeader() {
            const division = document.getElementById('division').value;
            const tableHead = document.getElementById('tableHead');
            let headers = '';

            if (division === 'DAILY JOB') {
                headers = '<tr><th>No</th><th>Kegiatan</th><th>Start Date</th><th>Target Date</th><th>Finish Date</th><th>Catatan Progress</th><th>Edit</th><th>Hapus</th></tr>';
            } else {
                headers = '<tr><th>No</th><th>Divisi</th><th>Date</th><th>Nama Barang</th><th>Banyaknya</th><th>Jenis</th><th>Catatan</th><th>Edit</th><th>Hapus</th></tr>';
            }

            tableHead.innerHTML = headers;
        }

        function addData() {
            const division = document.getElementById('division').value;
            let row = {};

            if (division === 'DAILY JOB') {
                row = {
                    No: data.length + 1,
                    Kegiatan: document.getElementById('activity').value,
                    'Start Date': document.getElementById('startDate').value,
                    'Target Date': document.getElementById('targetDate').value,
                    'Finish Date': document.getElementById('finishDate').value,
                    'Catatan Progress': document.getElementById('progressNotes').value
                };
            } else {
                row = {
                    No: data.length + 1,
                    Divisi: document.getElementById('division').value,
                    Date: document.getElementById('date').value,
                    'Nama Barang': document.getElementById('itemNameSelect').style.display === 'none' ? document.getElementById('itemNameInput').value : document.getElementById('itemNameSelect').value,
                    Banyaknya: document.getElementById('quantity').value,
                    Jenis: document.getElementById('type').value,
                    Catatan: document.getElementById('notes').value
                };
            }

            data.push(row);
            renderTable();
        }

        function renderTable() {
            const tableBody = document.querySelector('#preview tbody');
            tableBody.innerHTML = '';

            data.forEach((row, index) => {
                const tr = document.createElement('tr');
                for (const key in row) {
                    const td = document.createElement('td');
                    td.textContent = row[key];
                    tr.appendChild(td);
                }
                const editButton = document.createElement('button');
                editButton.textContent = 'Edit';
                editButton.className = 'action-buttons edit-button';
                editButton.onclick = () => alert('Edit functionality not implemented');

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Hapus';
                deleteButton.className = 'action-buttons delete-button';
                deleteButton.onclick = () => {
                    data.splice(index, 1);
                    renderTable();
                };

                const actionTd = document.createElement('td');
                actionTd.className = 'action-buttons';
                actionTd.appendChild(editButton);
                actionTd.appendChild(deleteButton);

                tr.appendChild(actionTd);
                tableBody.appendChild(tr);
            });
        }

        function saveToExcel() {
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Laporan Stock");
            XLSX.writeFile(wb, "Laporan_Stock.xlsx");
        }
    </script>
</body>
</html>
