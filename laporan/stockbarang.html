<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        form button:hover {
            background-color: #218838;
        }

        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table thead {
            background-color: #007bff;
            color: white;
        }

        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: #007bff;
            color: white;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-button {
            background-color: #ffc107;
            color: white;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: white;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Input Data</h1>
    <form id="dataForm">
        <label for="division">Divisi:</label>
        <select id="division" name="division" required onchange="updateForm()">
            <option value="">-- Pilih Divisi --</option>
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <div id="commonFields">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date">
            <label for="itemName">Nama Barang:</label>
            <div id="itemNameContainer">
                <select id="itemNameSelect" name="itemName">
                    <!-- Options will be populated based on division selection -->
                </select>
                <input type="text" id="itemNameInput" name="itemName" style="display: none;">
            </div>
            <label for="type">Jenis:</label>
            <select id="type" name="type">
                <option value="Material Masuk">Material Masuk</option>
                <option value="Material Terpakai">Material Terpakai</option>
                <option value="Material Reject">Material Reject</option>
                <option value="Potongan Reject">Potongan Reject</option>
            </select>
            <label for="quantity">Banyaknya:</label>
            <input type="number" id="quantity" name="quantity">
            <label for="notes">Catatan:</label>
            <input type="text" id="notes" name="notes">
        </div>
        <div id="dailyJobFields" style="display: none;">
            <label for="activity">Kegiatan:</label>
            <input type="text" id="activity" name="activity">
            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate">
            <label for="targetDate">Target Date:</label>
            <input type="date" id="targetDate" name="targetDate">
            <label for="finishDate">Finish Date:</label>
            <input type="date" id="finishDate" name="finishDate">
            <label for="progressNotes">Catatan Progress:</label>
            <input type="text" id="progressNotes" name="progressNotes">
        </div>
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Preview</h2>
    <div id="preview">
        <table>
            <thead id="tableHead">
                <!-- Table headers will be populated based on division selection -->
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script>
        const data = [];

        function updateForm() {
            const division = document.getElementById('division').value;
            const commonFields = document.getElementById('commonFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');

            if (division === 'DAILY JOB') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'block';
                itemNameInput.required = false;
                itemNameSelect.required = false;
            } else {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                updateItemNames();
            }

            updateTableHeader();
        }

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');
            
            if (division === 'DAILY JOB') {
                itemNameSelect.style.display = 'none';
                itemNameInput.style.display = 'block';
            } else {
                itemNameSelect.style.display = 'block';
                itemNameInput.style.display = 'none';
                itemNameSelect.innerHTML = '<option value="">-- Pilih Nama Barang --</option>';
                let items = [];
				if (division === 'INDOOR') {
					items = ['DOKU TONER BLACK', 'DOKU TONER CYAN', 'DOKU TONER MAGENTA', 'DOKU TONER YELLOW', 'KERTAS ARTCARTON / BW A3+', 'KERTAS ARTPAPER A3+', 'KERTAS BRIEF CARD / BC F4', 'KERTAS BUFALO BIRU', 'KERTAS BUFALO HIJAU', 'KERTAS BUFALO KUNING', 'KERTAS BUFALO MERAH', 'KERTAS BUFALO ORANGE', 'KERTAS BUFALO PINK', 'KERTAS BUFALO PUTIH', 'KERTAS BUFALO SKY BLUE', 'KERTAS BUFALO UNGU', 'KERTAS FOTO', 'KERTAS HVS A3 PUTIH', 'KERTAS HVS A3+ PUTIH', 'KERTAS HVS A4 PUTIH', 'KERTAS HVS F4 BIRU', 'KERTAS HVS F4 HIJAU', 'KERTAS HVS F4 KUNING', 'KERTAS HVS F4 MERAH', 'KERTAS HVS F4 PUTIH', 'KERTAS NCR KUNING', 'KERTAS NCR PUTIH', 'KERTAS NCR PINK', 'KERTAS NCR UNGU'];
				} else if (division === 'OUTDOOR') {
					items = ['ALUMUNIUM', 'BANNER FRONTLITE', 'BANNER LUSTER', 'BANNER MATTE', 'BANNER VYNIL PUTIH 3M', 'CUTTER ROLL', 'CUTTER STICKER 24"', 'CUTTER STICKER 36"', 'CUTTER STICKER 48"', 'CUTTER STICKER 60"', 'DOUBLE TIP KARET', 'INK BLACK LUSO', 'INK CYAN LUSO', 'INK MAGENTA LUSO', 'INK YELLOW LUSO', 'KERTAS ROLL 24"', 'KERTAS ROLL 36"', 'KERTAS ROLL 48"', 'KERTAS ROLL 60"', 'KERTAS ROLL 72"', 'PVC PUTIH', 'ROLL 24"', 'ROLL 36"', 'ROLL 48"', 'ROLL 60"'];
				} else if (division === 'PRODUKSI') {
					items = ['ALUMUNIUM 1,5 MM', 'ALUMUNIUM 2 MM', 'AVOLON', 'CORRUGATE', 'KARET 1 CM', 'KARET 2 CM', 'KARET 3 CM', 'LUBANG', 'MS PLAT HITAM', 'MS PLAT KUNING', 'PLAT STAINLESS'];
				} else if (division === 'GUDANG') {
					items = ['AC ACER', 'AC AUDIO', 'AC GREE', 'AC LG', 'AC PANASONIC', 'AC POLYTRON', 'AC SAMSUNG', 'AC SHARP', 'AC TOSHIBA', 'ASBES', 'BOLAM LED'];
				} else if (division === 'PURCHASE ORDER') {
					items = ['ITEM 1', 'ITEM 2', 'ITEM 3'];
				} else if (division === 'ORDER PERMINTAAN BARANG') {
					items = ['ORDER ITEM 1', 'ORDER ITEM 2', 'ORDER ITEM 3'];
				}
                items.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.textContent = item;
                    itemNameSelect.appendChild(option);
                });
            }
        }

        function updateTableHeader() {
            const division = document.getElementById('division').value;
            const tableHead = document.getElementById('tableHead');

            let headers = '';
            if (division === 'DAILY JOB') {
                headers = `
                    <tr>
                        <th>Kegiatan</th>
                        <th>Start Date</th>
                        <th>Target Date</th>
                        <th>Finish Date</th>
                        <th>Catatan Progress</th>
                        <th>Actions</th>
                    </tr>`;
            } else {
                headers = `
                    <tr>
                        <th>Divisi</th>
                        <th>Date</th>
                        <th>Nama Barang</th>
                        <th>Jenis</th>
                        <th>Banyaknya</th>
                        <th>Catatan</th>
                        <th>Actions</th>
                    </tr>`;
            }

            tableHead.innerHTML = headers;
        }

        function addData() {
            const form = document.getElementById('dataForm');
            const formData = new FormData(form);
            const entry = Object.fromEntries(formData.entries());
            data.push(entry);
            updateTable();
            form.reset();
        }

        function updateTable() {
            const division = document.getElementById('division').value;
            const tbody = document.querySelector('table tbody');
            tbody.innerHTML = '';

            data.forEach((entry, index) => {
                let row = document.createElement('tr');

                if (division === 'DAILY JOB') {
                    row.innerHTML = `
                        <td>${entry.activity || ''}</td>
                        <td>${entry.startDate || ''}</td>
                        <td>${entry.targetDate || ''}</td>
                        <td>${entry.finishDate || ''}</td>
                        <td>${entry.progressNotes || ''}</td>
                        <td class="action-buttons">
                            <button class="edit-button" onclick="editEntry(${index})">Edit</button>
                            <button class="delete-button" onclick="deleteEntry(${index})">Delete</button>
                        </td>`;
                } else {
                    row.innerHTML = `
                        <td>${entry.division || ''}</td>
                        <td>${entry.date || ''}</td>
                        <td>${entry.itemName || ''}</td>
                        <td>${entry.type || ''}</td>
                        <td>${entry.quantity || ''}</td>
                        <td>${entry.notes || ''}</td>
                        <td class="action-buttons">
                            <button class="edit-button" onclick="editEntry(${index})">Edit</button>
                            <button class="delete-button" onclick="deleteEntry(${index})">Delete</button>
                        </td>`;
                }

                tbody.appendChild(row);
            });
        }

        function editEntry(index) {
            const entry = data[index];
            Object.entries(entry).forEach(([key, value]) => {
                document.getElementById(key).value = value;
            });
            deleteEntry(index);
        }

        function deleteEntry(index) {
            data.splice(index, 1);
            updateTable();
        }

        function saveToExcel() {
            const workbook = XLSX.utils.book_new();
            const worksheet = XLSX.utils.json_to_sheet(data);
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
            XLSX.writeFile(workbook, 'Laporan_Stock.xlsx');
        }

        updateForm();
    </script>
</body>
</html>
