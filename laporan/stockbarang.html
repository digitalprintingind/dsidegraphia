<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        form button:hover {
            background-color: #218838;
        }

        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table thead {
            background-color: #007bff;
            color: white;
        }

        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: #007bff;
            color: white;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-button {
            background-color: #ffc107;
            color: white;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: white;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>LAPORAN STOCK BARANG</h1>
    <form id="dataForm">
        <label for="division">Divisi:</label>
        <select id="division" name="division" required onchange="updateForm()">
            <option value="">-- Pilih Divisi --</option>
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <div id="commonFields">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date">
            <label for="itemName">Nama Barang:</label>
            <div id="itemNameContainer">
                <select id="itemNameSelect" name="itemName">
                    <!-- Options will be populated based on division selection -->
                </select>
                <input type="text" id="itemNameInput" name="itemName" style="display: none;">
            </div>
            <label for="type">Jenis:</label>
            <select id="type" name="type">
                <option value="Material Masuk">Material Masuk</option>
                <option value="Material Terpakai">Material Terpakai</option>
                <option value="Material Reject">Material Reject</option>
                <option value="Potongan Reject">Potongan Reject</option>
            </select>
            <label for="quantity">Banyaknya:</label>
            <input type="number" id="quantity" name="quantity">
            <label for="notes">Catatan:</label>
            <input type="text" id="notes" name="notes">
        </div>
        <div id="dailyJobFields" style="display: none;">
            <label for="activity">Kegiatan:</label>
            <input type="text" id="activity" name="activity">
            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate">
            <label for="targetDate">Target Date:</label>
            <input type="date" id="targetDate" name="targetDate">
            <label for="finishDate">Finish Date:</label>
            <input type="date" id="finishDate" name="finishDate">
            <label for="progressNotes">Catatan Progress:</label>
            <input type="text" id="progressNotes" name="progressNotes">
        </div>
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Preview</h2>
    <div id="preview">
        <table>
            <thead id="tableHead">
                <!-- Table headers will be populated based on division selection -->
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script>
        const data = [];

        function updateForm() {
            const division = document.getElementById('division').value;
            const commonFields = document.getElementById('commonFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');

            if (division === 'DAILY JOB') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'block';
                itemNameInput.required = false;
                itemNameSelect.required = false;
            } else {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                updateItemNames();
            }

            updateTableHeader();
        }

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');
            
            if (division === 'DAILY JOB') {
                itemNameSelect.style.display = 'none';
                itemNameInput.style.display = 'block';
            } else {
                itemNameSelect.style.display = 'block';
                itemNameInput.style.display = 'none';
                itemNameSelect.innerHTML = '<option value="">-- Pilih Nama Barang --</option>';
                let items = [];
				if (division === 'INDOOR') {
					items = ['DOKU TONER BLACK', 'DOKU TONER CYAN', 'DOKU TONER MAGENTA', 'DOKU TONER YELLOW', 'KERTAS ARTCARTON / BW A3+', 'KERTAS ARTPAPER A3+', 'KERTAS BRIEF CARD / BC F4', 'KERTAS BUFALO BIRU', 'KERTAS BUFALO HIJAU', 'KERTAS BUFALO KUNING', 'KERTAS BUFALO MERAH', 'KERTAS BUFALO ORANGE', 'KERTAS BUFALO PINK', 'KERTAS BUFALO PUTIH', 'KERTAS BUFALO SKY BLUE', 'KERTAS BUFALO UNGU', 'KERTAS FOTO', 'KERTAS HVS A3 PUTIH', 'KERTAS HVS A3+ PUTIH', 'KERTAS HVS A4 PUTIH', 'KERTAS HVS F4 BIRU', 'KERTAS HVS F4 HIJAU', 'KERTAS HVS F4 KUNING', 'KERTAS HVS F4 MERAH', 'KERTAS HVS F4 PUTIH', 'KERTAS INJECT', 'KERTAS KALKIR', 'KERTAS LINEN A3', 'KERTAS LINEN A4', 'KERTAS NCR BIRU', 'KERTAS NCR HIJAU', 'KERTAS NCR KUNING', 'KERTAS NCR MERAH', 'KERTAS NCR PUTIH', 'KERTAS SUBLIME A4', 'MASKING STIKER 10 CM', 'MASKING STIKER 15 CM', 'PVC ID CARD', 'STIKER CROMO A3+', 'STIKER HOLOGRAM A3+', 'STIKER POLIFLEX GOLD', 'STIKER POLIFLEX HITAM', 'STIKER POLIFLEX PUTIH', 'STIKER SKOTLET BIRU', 'STIKER SKOTLET GOLD', 'STIKER SKOTLET HIJAU', 'STIKER SKOTLET HITAM', 'STIKER SKOTLET KUNING', 'STIKER SKOTLET MERAH', 'STIKER SKOTLET ORANGE', 'STIKER SKOTLET PUTIH', 'STIKER SKOTLET SILVER', 'STIKER TRANSPARANT A3+', 'STIKER VINYL A3+', 'TINTA DIAMOND ART BIRU', 'TINTA DIAMOND ART HITAM', 'TINTA DIAMOND ART KUNING', 'TINTA DIAMOND ART MERAH', 'TRANSFER PAPER / OPACK'];
				} else if (division === 'OUTDOOR') {
					items = ['ECO SOLVEN', 'FLEXY CHINA 300 GR', 'FLEXY CHINA 340 GR', 'KOREA CHINA 440 GR', 'LEM HANDSOME', 'MATIK', 'STAND ROLL UP BANNER', 'STAND Y-BANNER', 'STIKER ONE WAY', 'STIKER TRANSPARANT', 'STIKER VINYL METER', 'TINTA BLACK / HITAM', 'TINTA CYAN / BIRU', 'TINTA RED / MERAH', 'TINTA YELLOW / KUNING', 'TISU KEPING', 'Y BANNER MINI A3', 'FLEXY CHINA 280 GR'];
				} else if (division === 'PRODUKSI') {
					items = ['CAT KARUNG HIJAU', 'CAT KARUNG HITAM', 'CAT KARUNG KUNING', 'CAT KARUNG MERAH', 'Cat Plastisol Hitam', 'CAT PLASTISOL KUNING', 'Cat Plastisol Merah', 'CAT PLASTISOL PUTIH', 'kain asahi', 'Kain Milano Hitam', 'Kain Milano Putih', 'Karung Mulyana Polos 25 Kg', 'Karung Mulyana Polos 50 Kg', 'M4', 'PLASTIK JERSEY', 'PLASTIK KAOS', 'SUMO 50 Kg Transparant', 'SUMO 25 Kg Transparant', 'HOKI 50 Kg Doff Putih', 'HOKI 25 Kg Doff Putih', 'PILOT 50 Kg Transparant', 'PILOT 25 Kg Transparant', 'PILOT 10 Kg Transparant', 'KEPALA SINGA 50 Kg Transparant', 'KTI 50 Kg Transparant', 'KTI 25 Kg Transparant', 'MERCUSUAR 50 Doff Putih', 'MERCURUAS 25 Doff Putih', 'KARUNG 110x150 Doff Putih Garis Biru'];
				} else if (division === 'GUDANG') {
					items = ['Akrilik Name Tag', 'Box Kartu Nama', 'CUTTING MAT A3', 'CUTTING MAT A4', 'DUS MUG', 'GANCI PIN 44mm', 'GANCI PIN 58mm', 'GUNTING', 'Hanger', 'KANTONG PELASTIK BESAR', 'KANTONG PELASTIK SEDANG', 'Karet Stempel Flash', 'KARTON', 'KATER', 'Kawat Spiral 03 = 4 - 6 Lembar', 'Kawat Spiral 04 = 7 - 10 Lembar', 'Kawat Spiral 05 = 11 - 20 Lembar', 'Kawat Spiral 06 = 21 - 35 Lembar', 'Kawat Spiral 07 = 36 - 60 Lembar', 'Kawat Spiral 08 = 61 - 90 Lembar', 'Kawat Spiral 09 = 91 - 125 Lembar', 'Kawat Spiral 10 = 126 - 150 Lembar', 'Kawat Spiral 11 = 151 -175 Lembar', 'Kawat Spiral 12 = 176 - 225 Lembar', 'KERTAS SAMSON', 'Klem Kalender', 'LAKBAN KERTAS', 'LAKBAN UK.1 CM', 'LAKBAN UK.2,5 cm', 'LAKBAN UK.5 CM', 'Laminasy Doff A3', 'Laminasy Glossy A3', 'Laminatin A4', 'Laminatin F4', 'Lanyard', 'MASKER', 'MIKA', 'MUG', 'PENGHAPUS PUTIH', 'Peniti Name Tag', 'PIN 44mm', 'PIN 58mm', 'PIN Magnet 44mm', 'PIN Magnet 58mm', 'PLASTIK SLONGSONG 11 CM', 'Sempel CBO45', 'Stampel IT6018', 'Stempel CB0V35', 'Stempel CB0V45', 'Stempel CB0V51', 'Stempel CB1035', 'STEMPEL CB1340', 'Stempel CB1755', 'Stempel CB2255', 'Stempel CB2755', 'Stempel CB4040', 'Stempel CB4355', 'Stempel CB4367', 'Stempel CB4378', 'Stempel CBO17', 'Stempel CBO25', 'Stempel CBO28', 'Stempel CBO32', 'Stempel CBO35', 'Stempel CBO40', 'Stempel CBO45', 'Stempel IT3313', 'Stempel IT4515', 'Stiker Yupo', 'TALI RAPIAH ', 'Tinta Stampel Biru', 'Tinta Stampel Hijau', 'Tinta Stampel Hitam', 'Tinta Stampel Kuning', 'Tinta Stampel Merah', 'Tinta Stampel Orange', 'Tinta Stampel Ungu', 'TISU', 'Yoyo ID Card', 'MENDALI BULAT,SEGITIGA'];
                		} else if (division === 'PURCHASE ORDER') {
                  			items = ['Form Logo ISA Uk. A4', 'Form Logo ISA Uk. A5', 'Form Izin Keluar', 'Form Delivery Note A5', 'Form Delivery Note A4', 'Form Cuti A5', 'Form DRF A5', 'Form Of Cash Advance Realisation', 'Form Bukti Kas Keluar', 'Form Tanda Terima', 'Form Penyimpanan Limbah B3', 'Formulir Tamu A5', 'Form Permohonan Kas Bon', 'Form Kunjungan Klinik', 'Form Die Trial Schedule Slip', 'Form Surat Perintah Lembur', 'Tanda Terima', 'Bukti Kas Keluar', 'Permohonan Kas Bon', 'Bon Permintaan & Pemakaian Barang', 'Berita Acara Penerimaan Barang', 'KOP SURAT', 'Form Perpanjangan Jam Kerja', 'Formulir Tamu', 'Kartu Hasil Shearing', 'Laporan Kerja Harian Welding', 'Bukti BANK Keluar', 'KWITANSI', 'Kartu Ijin Khusus / Keluar', 'TAG OK "F"', 'TAG OK "W"', 'TAG OK "S"', 'TAG "NC"', 'TAG "NG"', 'TAG "UNFINISH PROCESS"', 'Form Data Reject', 'Bukti Kas Masuk', 'Kartu Inventory', 'Inventory Card', 'Form Laporan Troubel Quality', 'SKIN >PET< BOARD >PP<', 'X1', 'X2', '58410-BZ340-C0', '58410-BZ290-C0', '74102 - A1011 - D ( M )', '74101 - A1018 - F ( M1 )', '74101 - A1017 - F ( M2 )', '74101 - A1014 - F ( M5 )', '74102 - A1041', '74102 - A1042', '74102 - A1012 ( M )', '74101 - A1061 ( 290 )', 'LI-RAD40-STIC-010', 'LI-RAD40-STIC-020', 'LI-RAD40-STIC-030', 'LI-RAD40-STIC-020A', 'LI-RAD40-STIC-030A', '74511 - X7U58', '74511 - X7U59', '74511 - X7U60', '74511 - X7U61', '74511 - X7U62', '71405-A1044', '71405-A1045', '71405-A1046', '71405-A1047', '74103-A1011', '74103-A1012', '74103-A1013', '74103-A1014', '74103-A1015', '74103-A1016', '74103-A1017', '74103-A1018', 'LI-3ARAD40-STIC-040'];
                		} else if (division === 'ORDER PERMINTAAN BARANG') {
                    			items = ['Stampel', 'Mug', 'Pin'];
                		}

                items.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.text = item;
                    itemNameSelect.appendChild(option);
                });
            }
        }

        function updateTableHeader() {
            const tableHead = document.getElementById('tableHead');
            const division = document.getElementById('division').value;

            if (division === 'DAILY JOB') {
                tableHead.innerHTML = `
                    <tr>
                        <th>Kegiatan</th>
                        <th>Start Date</th>
                        <th>Target Date</th>
                        <th>Finish Date</th>
                        <th>Catatan Progress</th>
                        <th>Actions</th>
                    </tr>
                `;
            } else {
                tableHead.innerHTML = `
                    <tr>
                        <th>Date</th>
                        <th>Nama Barang</th>
                        <th>Jenis</th>
                        <th>Banyaknya</th>
                        <th>Catatan</th>
                        <th>Actions</th>
                    </tr>
                `;
            }
        }

        function validateInput() {
            const division = document.getElementById('division').value;
            if (!division) return false;

            if (division === 'DAILY JOB') {
                const activity = document.getElementById('activity').value;
                const startDate = document.getElementById('startDate').value;
                const targetDate = document.getElementById('targetDate').value;
                const finishDate = document.getElementById('finishDate').value;

                return activity && startDate && targetDate && finishDate;
            } else {
                const date = document.getElementById('date').value;
                const itemName = document.getElementById('itemNameSelect').value || document.getElementById('itemNameInput').value;
                const type = document.getElementById('type').value;
                const quantity = document.getElementById('quantity').value;

                return date && itemName && type && quantity;
            }
        }

        function addData() {
            if (!validateInput()) {
                alert('Harap isi semua input yang diperlukan.');
                return;
            }

            const division = document.getElementById('division').value;
            if (division === 'DAILY JOB') {
                const activity = document.getElementById('activity').value;
                const startDate = document.getElementById('startDate').value;
                const targetDate = document.getElementById('targetDate').value;
                const finishDate = document.getElementById('finishDate').value;
                const progressNotes = document.getElementById('progressNotes').value;

                data.push({
                    division,
                    activity,
                    startDate,
                    targetDate,
                    finishDate,
                    progressNotes
                });
            } else {
                const date = document.getElementById('date').value;
                const itemName = document.getElementById('itemNameSelect').value || document.getElementById('itemNameInput').value;
                const type = document.getElementById('type').value;
                const quantity = document.getElementById('quantity').value;
                const notes = document.getElementById('notes').value;

                data.push({
                    division,
                    date,
                    itemName,
                    type,
                    quantity,
                    notes
                });
            }

            updateTable();
            clearForm();
        }

        function updateTable() {
            const tableBody = document.querySelector('#preview tbody');
            tableBody.innerHTML = ''; // Clear previous data

            data.forEach((row, index) => {
                const tr = document.createElement('tr');

                if (row.division === 'DAILY JOB') {
                    tr.innerHTML = `
                        <td>${row.activity}</td>
                        <td>${row.startDate}</td>
                        <td>${row.targetDate}</td>
                        <td>${row.finishDate}</td>
                        <td>${row.progressNotes}</td>
                        <td class="action-buttons">
                            <button class="edit-button" onclick="editData(${index})">Edit</button>
                            <button class="delete-button" onclick="deleteData(${index})">Delete</button>
                        </td>
                    `;
                } else {
                    tr.innerHTML = `
                        <td>${row.date}</td>
                        <td>${row.itemName}</td>
                        <td>${row.type}</td>
                        <td>${row.quantity}</td>
                        <td>${row.notes}</td>
                        <td class="action-buttons">
                            <button class="edit-button" onclick="editData(${index})">Edit</button>
                            <button class="delete-button" onclick="deleteData(${index})">Delete</button>
                        </td>
                    `;
                }

                tableBody.appendChild(tr);
            });
        }

        function clearForm() {
            document.getElementById('dataForm').reset();
            updateForm();
        }

        function editData(index) {
            const row = data[index];
            const division = document.getElementById('division');
            division.value = row.division;
            updateForm();

            if (row.division === 'DAILY JOB') {
                document.getElementById('activity').value = row.activity;
                document.getElementById('startDate').value = row.startDate;
                document.getElementById('targetDate').value = row.targetDate;
                document.getElementById('finishDate').value = row.finishDate;
                document.getElementById('progressNotes').value = row.progressNotes;
            } else {
                document.getElementById('date').value = row.date;
                if (row.division === 'INDOOR' || row.division === 'OUTDOOR' || row.division === 'PRODUKSI' || row.division === 'GUDANG' || row.division === 'PURCHASE ORDER' || row.division === 'ORDER PERMINTAAN BARANG') {
                    document.getElementById('itemNameSelect').value = row.itemName;
                } else {
                    document.getElementById('itemNameInput').value = row.itemName;
                }
                document.getElementById('type').value = row.type;
                document.getElementById('quantity').value = row.quantity;
                document.getElementById('notes').value = row.notes;
            }

            data.splice(index, 1);
            updateTable();
        }

        function deleteData(index) {
            data.splice(index, 1);
            updateTable();
        }

        function saveToExcel() {
            const filteredData = data.map(row => {
                const { division, ...rest } = row; // Spread operator to exclude 'division'
                return rest;
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(filteredData, { header: Object.keys(filteredData[0]) });
            XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
            
            const currentDate = new Date().toISOString().split('T')[0];
            const fileName = `${currentDate}.xlsx`;
            
            XLSX.writeFile(wb, fileName);
        }

        document.addEventListener('DOMContentLoaded', () => {
            updateForm(); // Initialize form fields based on initial division value
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
</body>
</html>
