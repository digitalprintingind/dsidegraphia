<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        form button:hover {
            background-color: #218838;
        }

        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table thead {
            background-color: #007bff;
            color: white;
        }

        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: #007bff;
            color: white;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-button {
            background-color: #ffc107;
            color: white;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: white;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Input Data</h1>
    <form id="dataForm">
        <label for="division">Divisi:</label>
        <select id="division" name="division" required onchange="updateForm()">
            <option value="">-- Pilih Divisi --</option>
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <div id="commonFields">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date">
            <label for="itemName">Nama Barang:</label>
            <div id="itemNameContainer">
                <select id="itemNameSelect" name="itemName">
                    <!-- Options will be populated based on division selection -->
                </select>
                <input type="text" id="itemNameInput" name="itemName" style="display: none;">
            </div>
            <label for="type" id="typeLabel">Jenis:</label>
            <select id="type" name="type">
                <option value="Material Masuk">Material Masuk</option>
                <option value="Material Terpakai">Material Terpakai</option>
                <option value="Material Reject">Material Reject</option>
                <option value="Potongan Reject">Potongan Reject</option>
            </select>
            <label for="quantity">Banyaknya:</label>
            <input type="number" id="quantity" name="quantity">
            <label for="notes">Catatan:</label>
            <input type="text" id="notes" name="notes">
        </div>
        <div id="dailyJobFields" style="display: none;">
            <label for="activity">Kegiatan:</label>
            <input type="text" id="activity" name="activity">
            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate">
            <label for="targetDate">Target Date:</label>
            <input type="date" id="targetDate" name="targetDate">
            <label for="finishDate">Finish Date:</label>
            <input type="date" id="finishDate" name="finishDate">
            <label for="progressNotes">Catatan Progress:</label>
            <input type="text" id="progressNotes" name="progressNotes">
        </div>
        <div id="orderPermintaanBarangFields" style="display: none;">
            <label for="statusProses">Status Proses:</label>
            <select id="statusProses" name="statusProses">
                <option value="Belanja">Belanja</option>
                <option value="Selesai">Selesai</option>
            </select>
        </div>
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Preview</h2>
    <div id="preview">
        <table>
            <thead id="tableHead">
                <!-- Table headers will be populated based on division selection -->
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script>
        const data = [];
        const allItems = {
            INDOOR: ['DOKU TONER BLACK', 'DOKU TONER CYAN', 'DOKU TONER MAGENTA', 'DOKU TONER YELLOW', 'KERTAS ARTCARTON / BW A3+', 'KERTAS ARTPAPER A3+', 'KERTAS BRIEF CARD / BC F4', 'KERTAS BUFALO BIRU', 'KERTAS BUFALO HIJAU', 'KERTAS BUFALO KUNING', 'KERTAS BUFALO MERAH', 'KERTAS BUFALO ORANGE', 'KERTAS BUFALO PINK', 'KERTAS BUFALO PUTIH', 'KERTAS BUFALO SKY BLUE', 'KERTAS BUFALO UNGU', 'KERTAS FOTO', 'KERTAS HVS A3 PUTIH', 'KERTAS HVS A3+ PUTIH', 'KERTAS HVS A4 PUTIH', 'KERTAS HVS F4 BIRU', 'KERTAS HVS F4 HIJAU', 'KERTAS HVS F4 KUNING', 'KERTAS HVS F4 MERAH', 'KERTAS HVS F4 PUTIH', 'KERTAS INJECT', 'KERTAS KALKIR', 'KERTAS LINEN A3', 'KERTAS LINEN A4', 'KERTAS NCR BIRU', 'KERTAS NCR HIJAU', 'KERTAS NCR KUNING', 'KERTAS NCR MERAH', 'KERTAS NCR PUTIH', 'KERTAS SUBLIME A4', 'MASKING STIKER 10 CM', 'MASKING STIKER 15 CM', 'PVC ID CARD', 'STIKER CROMO A3+', 'STIKER HOLOGRAM A3+', 'STIKER POLIFLEX GOLD', 'STIKER POLIFLEX HITAM', 'STIKER POLIFLEX PUTIH', 'STIKER SKOTLET BIRU', 'STIKER SKOTLET GOLD', 'STIKER SKOTLET HIJAU', 'STIKER SKOTLET HITAM', 'STIKER SKOTLET KUNING', 'STIKER SKOTLET MERAH', 'STIKER SKOTLET ORANGE', 'STIKER SKOTLET PUTIH', 'STIKER SKOTLET SILVER', 'STIKER TRANSPARANT A3+', 'STIKER VINYL A3+', 'TINTA DIAMOND ART BIRU', 'TINTA DIAMOND ART HITAM', 'TINTA DIAMOND ART KUNING', 'TINTA DIAMOND ART MERAH', 'TRANSFER PAPER / OPACK'],
            OUTDOOR: ['ECO SOLVEN', 'FLEXY CHINA 300 GR', 'FLEXY CHINA 340 GR', 'KOREA CHINA 440 GR', 'LEM HANDSOME', 'MATIK', 'STAND ROLL UP BANNER', 'STAND Y-BANNER', 'STIKER ONE WAY', 'STIKER TRANSPARANT', 'STIKER VINYL METER', 'TINTA BLACK / HITAM', 'TINTA CYAN / BIRU', 'TINTA RED / MERAH', 'TINTA YELLOW / KUNING', 'TISU KEPING', 'Y BANNER MINI A3', 'FLEXY CHINA 280 GR'],
            PRODUKSI: ['CAT KARUNG HIJAU', 'CAT KARUNG HITAM', 'CAT KARUNG KUNING', 'CAT KARUNG MERAH', 'Cat Plastisol Hitam', 'CAT PLASTISOL KUNING', 'Cat Plastisol Merah', 'CAT PLASTISOL PUTIH', 'kain asahi', 'Kain Milano Hitam', 'Kain Milano Putih', 'Karung Mulyana Polos 25 Kg', 'Karung Mulyana Polos 50 Kg', 'M4', 'PLASTIK JERSEY', 'PLASTIK KAOS', 'SUMO 50 Kg Transparant', 'SUMO 25 Kg Transparant', 'HOKI 50 Kg Doff Putih', 'HOKI 25 Kg Doff Putih', 'PILOT 50 Kg Transparant', 'PILOT 25 Kg Transparant', 'PILOT 10 Kg Transparant', 'KEPALA SINGA 50 Kg Transparant', 'KTI 50 Kg Transparant', 'KTI 25 Kg Transparant', 'MERCUSUAR 50 Doff Putih', 'MERCURUAS 25 Doff Putih', 'KARUNG 110x150 Doff Putih Garis Biru'],
            GUDANG: ['Akrilik Name Tag', 'Box Kartu Nama', 'CUTTING MAT A3', 'CUTTING MAT A4', 'DUS MUG', 'GANCI PIN 44mm', 'GANCI PIN 58mm', 'GUNTING', 'Hanger', 'KANTONG PELASTIK BESAR', 'KANTONG PELASTIK SEDANG', 'Karet Stempel Flash', 'KARTON', 'KATER', 'Kawat Spiral 03 = 4 - 6 Lembar', 'Kawat Spiral 04 = 7 - 10 Lembar', 'Kawat Spiral 05 = 11 - 20 Lembar', 'Kawat Spiral 06 = 21 - 35 Lembar', 'Kawat Spiral 07 = 36 - 60 Lembar', 'Kawat Spiral 08 = 61 - 90 Lembar', 'Kawat Spiral 09 = 91 - 125 Lembar', 'Kawat Spiral 10 = 126 - 150 Lembar', 'Kawat Spiral 11 = 151 -175 Lembar', 'Kawat Spiral 12 = 176 - 225 Lembar', 'KERTAS SAMSON', 'Klem Kalender', 'LAKBAN KERTAS', 'LAKBAN UK.1 CM', 'LAKBAN UK.2,5 cm', 'LAKBAN UK.5 CM', 'Laminasy Doff A3', 'Laminasy Glossy A3', 'Laminatin A4', 'Laminatin F4', 'Lanyard', 'MASKER', 'MIKA', 'MUG', 'PENGHAPUS PUTIH', 'Peniti Name Tag', 'PIN 44mm', 'PIN 58mm', 'PIN Magnet 44mm', 'PIN Magnet 58mm', 'PLASTIK SLONGSONG 11 CM', 'Sempel CBO45', 'Stampel IT6018', 'Stempel CB0V35', 'Stempel CB0V45', 'Stempel CB0V51', 'Stempel CB1035', 'STEMPEL CB1340', 'Stempel CB1755', 'Stempel CB2255', 'Stempel CB2755', 'Stempel CB4040', 'Stempel CB4355', 'Stempel CB4367', 'Stempel CB4378', 'Stempel CBO17', 'Stempel CBO25', 'Stempel CBO28', 'Stempel CBO32', 'Stempel CBO35', 'Stempel CBO40', 'Stempel CBO45', 'Stempel IT3313', 'Stempel IT4515', 'Stiker Yupo', 'TALI RAPIAH ', 'Tinta Stampel Biru', 'Tinta Stampel Hijau', 'Tinta Stampel Hitam', 'Tinta Stampel Kuning', 'Tinta Stampel Merah', 'Tinta Stampel Orange', 'Tinta Stampel Ungu', 'TISU', 'Yoyo ID Card', 'MENDALI BULAT,SEGITIGA'],
            PURCHASE ORDER: ['Form Logo ISA Uk. A4', 'Form Logo ISA Uk. A5', 'Form Izin Keluar', 'Form Delivery Note A5', 'Form Delivery Note A4', 'Form Cuti A5', 'Form DRF A5', 'Form Of Cash Advance Realisation', 'Form Bukti Kas Keluar', 'Form Tanda Terima', 'Form Penyimpanan Limbah B3', 'Formulir Tamu A5', 'Form Permohonan Kas Bon', 'Form Kunjungan Klinik', 'Form Die Trial Schedule Slip', 'Form Surat Perintah Lembur', 'Tanda Terima', 'Bukti Kas Keluar', 'Permohonan Kas Bon', 'Bon Permintaan & Pemakaian Barang', 'Berita Acara Penerimaan Barang', 'KOP SURAT', 'Form Perpanjangan Jam Kerja', 'Formulir Tamu', 'Kartu Hasil Shearing', 'Laporan Kerja Harian Welding', 'Bukti BANK Keluar', 'KWITANSI', 'Kartu Ijin Khusus / Keluar', 'TAG OK "F"', 'TAG OK "W"', 'TAG OK "S"', 'TAG "NC"', 'TAG "NG"', 'TAG "UNFINISH PROCESS"', 'Form Data Reject', 'Bukti Kas Masuk', 'Kartu Inventory', 'Inventory Card', 'Form Laporan Troubel Quality', 'SKIN >PET< BOARD >PP<', 'X1', 'X2', '58410-BZ340-C0', '58410-BZ290-C0', '74102 - A1011 - D ( M )', '74101 - A1018 - F ( M1 )', '74101 - A1017 - F ( M2 )', '74101 - A1014 - F ( M5 )', '74102 - A1041', '74102 - A1042', '74102 - A1012 ( M )', '74101 - A1061 ( 290 )', 'LI-RAD40-STIC-010', 'LI-RAD40-STIC-020', 'LI-RAD40-STIC-030', 'LI-RAD40-STIC-020A', 'LI-RAD40-STIC-030A', '74511 - X7U58', '74511 - X7U59', '74511 - X7U60', '74511 - X7U61', '74511 - X7U62', '71405-A1044', '71405-A1045', '71405-A1046', '71405-A1047', '74103-A1011', '74103-A1012', '74103-A1013', '74103-A1014', '74103-A1015', '74103-A1016', '74103-A1017', '74103-A1018', 'LI-3ARAD40-STIC-040']
        };

        function updateForm() {
            const division = document.getElementById('division').value;
            const commonFields = document.getElementById('commonFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const orderPermintaanBarangFields = document.getElementById('orderPermintaanBarangFields');
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');
            const typeField = document.getElementById('type');
            const typeLabel = document.getElementById('typeLabel');

            if (division === 'DAILY JOB') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'block';
                orderPermintaanBarangFields.style.display = 'none';
                typeField.style.display = 'none';
                typeLabel.style.display = 'none';
                itemNameInput.required = false;
                itemNameSelect.required = false;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                orderPermintaanBarangFields.style.display = 'block';
                typeField.style.display = 'none';
                typeLabel.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                updateItemNames();
            } else {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                orderPermintaanBarangFields.style.display = 'none';
                typeField.style.display = 'block';
                typeLabel.style.display = 'block';
                itemNameInput.required = false;
                itemNameSelect.required = false;
                updateItemNames();
            }
        }

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemNameSelect');
            itemNameSelect.innerHTML = '';

            let items = [];
            if (division === 'ORDER PERMINTAAN BARANG') {
                Object.values(allItems).forEach(itemList => {
                    items = items.concat(itemList);
                });
            } else if (division === 'INDOOR') {
                items = allItems.INDOOR;
            } else if (division === 'OUTDOOR') {
                items = allItems.OUTDOOR;
            }

            items.forEach(item => {
                const option = document.createElement('option');
                option.value = item;
                option.textContent = item;
                itemNameSelect.appendChild(option);
            });
        }

        function updateTableHeader() {
            const division = document.getElementById('division').value;
            const tableHead = document.querySelector('#preview thead');
            let headers = [];

            if (division === 'DAILY JOB') {
                headers = ['Date', 'Kegiatan', 'Start Date', 'Target Date', 'Finish Date', 'Catatan Progress', 'Actions'];
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                headers = ['Divisi', 'Date', 'Nama Barang', 'Banyaknya', 'Status Proses', 'Actions'];
            } else {
                headers = ['Divisi', 'Date', 'Nama Barang', 'Jenis', 'Banyaknya', 'Catatan', 'Actions'];
            }

            tableHead.innerHTML = '';
            const tr = document.createElement('tr');
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                tr.appendChild(th);
            });
            tableHead.appendChild(tr);
        }

        function validateInput() {
            const division = document.getElementById('division').value;
            if (division === 'DAILY JOB') {
                return document.getElementById('activity').value && 
                       document.getElementById('startDate').value && 
                       document.getElementById('targetDate').value &&
                       document.getElementById('finishDate').value &&
                       document.getElementById('progressNotes').value;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                return document.getElementById('date').value &&
                       (document.getElementById('itemNameSelect').value || document.getElementById('itemNameInput').value) &&
                       document.getElementById('quantity').value &&
                       document.getElementById('statusProses').value;
            } else {
                return document.getElementById('date').value &&
                       (document.getElementById('itemNameSelect').value || document.getElementById('itemNameInput').value) &&
                       document.getElementById('quantity').value;
            }
        }

        function addData() {
            if (!validateInput()) {
                alert('Please fill all required fields');
                return;
            }

            const division = document.getElementById('division').value;
            let entry = {
                Divisi: division,
                Date: division === 'DAILY JOB' ? document.getElementById('startDate').value : document.getElementById('date').value,
                NamaBarang: division === 'DAILY JOB' ? document.getElementById('activity').value : document.getElementById('itemNameSelect').value || document.getElementById('itemNameInput').value,
                Jenis: division === 'DAILY JOB' ? '' : document.getElementById('type').value,
                Banyaknya: division === 'DAILY JOB' ? '' : document.getElementById('quantity').value,
                Catatan: division === 'DAILY JOB' ? document.getElementById('progressNotes').value : document.getElementById('notes').value,
                StatusProses: division === 'ORDER PERMINTAAN BARANG' ? document.getElementById('statusProses').value : '',
                StartDate: division === 'DAILY JOB' ? document.getElementById('startDate').value : '',
                TargetDate: division === 'DAILY JOB' ? document.getElementById('targetDate').value : '',
                FinishDate: division === 'DAILY JOB' ? document.getElementById('finishDate').value : ''
            };

            data.push(entry);
            updateTable();
            clearForm();
        }

        function updateTable() {
            const tableBody = document.querySelector('#preview tbody');
            const division = document.getElementById('division').value;

            tableBody.innerHTML = '';

            data.forEach((entry, index) => {
                const tr = document.createElement('tr');
                for (const key in entry) {
                    if (entry.hasOwnProperty(key)) {
                        const td = document.createElement('td');
                        td.textContent = entry[key];
                        tr.appendChild(td);
                    }
                }
                const tdActions = document.createElement('td');
                tdActions.className = 'action-buttons';
                const editButton = document.createElement('button');
                editButton.textContent = 'Edit';
                editButton.className = 'edit-button';
                editButton.onclick = () => editData(index);
                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Delete';
                deleteButton.className = 'delete-button';
                deleteButton.onclick = () => deleteData(index);
                tdActions.appendChild(editButton);
                tdActions.appendChild(deleteButton);
                tr.appendChild(tdActions);
                tableBody.appendChild(tr);
            });
        }

        function clearForm() {
            document.getElementById('dataForm').reset();
            document.getElementById('division').value = '';
            updateForm();
        }

        function editData(index) {
            const entry = data[index];
            document.getElementById('division').value = entry.Divisi;
            document.getElementById('date').value = entry.Date;
            document.getElementById('itemNameSelect').value = entry.NamaBarang;
            document.getElementById('itemNameInput').value = entry.NamaBarang;
            document.getElementById('type').value = entry.Jenis;
            document.getElementById('quantity').value = entry.Banyaknya;
            document.getElementById('notes').value = entry.Catatan;
            document.getElementById('statusProses').value = entry.StatusProses;
            document.getElementById('startDate').value = entry.StartDate;
            document.getElementById('targetDate').value = entry.TargetDate;
            document.getElementById('finishDate').value = entry.FinishDate;
            document.getElementById('progressNotes').value = entry.Catatan;

            data.splice(index, 1);
            updateTable();
        }

        function deleteData(index) {
            data.splice(index, 1);
            updateTable();
        }

        function saveToExcel() {
            const workbook = XLSX.utils.book_new();
            const worksheet = XLSX.utils.json_to_sheet(data);
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Data');
            XLSX.writeFile(workbook, 'data.xlsx');
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</body>
</html>
