<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
        }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        form, table {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"], input[type="date"], input[type="number"], select, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        textarea {
            resize: vertical;
            height: 100px;
        }
        button[type="submit"], button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button[type="submit"]:hover, button:hover {
            background-color: #0056b3;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #007bff;
            color: #fff;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .hidden {
            display: none;
        }
        .action-buttons {
            display: flex;
            gap: 5px;
        }
    </style>
</head>
<body>
    <h1>Formulir Input Data</h1>
    <form onsubmit="addData(); return false;">
        <fieldset>
            <legend>Informasi Umum</legend>
            <label for="division">Division</label>
            <select id="division" onchange="updateForm(); updateTableHeader();">
                <option value="INDOOR">INDOOR</option>
                <option value="OUTDOOR">OUTDOOR</option>
                <option value="PRODUKSI">PRODUKSI</option>
                <option value="GUDANG">GUDANG</option>
                <option value="PURCHASE ORDER">PURCHASE ORDER</option>
                <option value="DAILY JOB">DAILY JOB</option>
                <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
            </select>
        </fieldset>

        <!-- Fields for other divisions -->
        <fieldset id="generalFields">
            <legend>Informasi Detail</legend>
            <label for="date">Tanggal</label>
            <input type="date" id="date" required><br>

            <label for="itemNameSelect">Nama Barang</label>
            <select id="itemNameSelect"></select>
            <input type="text" id="itemNameInput" class="hidden"><br>

            <label for="type">Jenis</label>
            <input type="text" id="type" required><br>

            <label for="quantity">Banyaknya</label>
            <input type="number" id="quantity" required><br>

            <label for="notes">Catatan</label>
            <textarea id="notes"></textarea><br>
        </fieldset>

        <!-- Fields for DAILY JOB -->
        <fieldset id="dailyJobFields" class="hidden">
            <legend>Informasi Daily Job</legend>
            <label for="activity">Kegiatan</label>
            <input type="text" id="activity" required><br>

            <label for="startDate">Start Date</label>
            <input type="date" id="startDate" required><br>

            <label for="targetDate">Target Date</label>
            <input type="date" id="targetDate" required><br>

            <label for="finishDate">Finish Date</label>
            <input type="date" id="finishDate" required><br>

            <label for="progressNotes">Catatan Progress</label>
            <textarea id="progressNotes"></textarea><br>
        </fieldset>

        <!-- Fields for ORDER PERMINTAAN BARANG -->
        <fieldset id="orderPermintaanBarangFields" class="hidden">
            <legend>Informasi Order Permintaan Barang</legend>
            <label for="opbItemName">Nama Barang</label>
            <input type="text" id="opbItemName" required><br>

            <label for="opbDate">Tanggal</label>
            <input type="date" id="opbDate" required><br>

            <label for="opbQuantity">Banyaknya</label>
            <input type="number" id="opbQuantity" required><br>

            <label for="opbStatus">Status Proses</label>
            <input type="text" id="opbStatus" required><br>
        </fieldset>

        <button type="submit">Add</button>
    </form>

    <table>
        <thead id="tableHead"></thead>
        <tbody id="tableBody"></tbody>
    </table>

    <button onclick="saveToExcel()">Save to Excel</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.1/xlsx.full.min.js"></script>
    <script>
        const data = [];

        function updateForm() {
            const division = document.getElementById('division').value;
            const generalFields = document.getElementById('generalFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const orderPermintaanBarangFields = document.getElementById('orderPermintaanBarangFields');

            generalFields.classList.add('hidden');
            dailyJobFields.classList.add('hidden');
            orderPermintaanBarangFields.classList.add('hidden');

            if (division === 'DAILY JOB') {
                dailyJobFields.classList.remove('hidden');
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                orderPermintaanBarangFields.classList.remove('hidden');
            } else {
                generalFields.classList.remove('hidden');
            }

            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');

            itemNameSelect.innerHTML = '';
            itemNameInput.value = '';

            if (division === 'DAILY JOB' || division === 'ORDER PERMINTAAN BARANG') {
                itemNameSelect.style.display = 'none';
                itemNameInput.style.display = 'block';
            } else {
                itemNameSelect.style.display = 'block';
                itemNameInput.style.display = 'none';

                let items = [];
                if (division === 'INDOOR') {
                    items = ['KERTAS ART CARTON 210 GR', 'KERTAS ART CARTON 230 GR', 'KERTAS ART CARTON 260 GR', 'KERTAS ART CARTON 310 GR', 'KERTAS ART PAPER 100 GR', 'KERTAS ART PAPER 120 GR', 'KERTAS BLUES WHITE 80 GR', 'KERTAS CORRUGATED', 'KERTAS HVS 70 GR', 'KERTAS HVS 80 GR', 'KERTAS HVS F4 PUTIH', 'KERTAS MATT PAPER A3+', 'KERTAS SAMSON 70 GR', 'LAMINASI DINGIN KILAP 310', 'LAMINASI DINGIN KILAP 43', 'LAMINASI DINGIN KILAP 60', 'LAMINASI DINGIN KILAP 90', 'LAMINASI DINGIN KILAP 125', 'LAMINASI DINGIN LUSTRE 31', 'LAMINASI DINGIN LUSTRE 43', 'LAMINASI DINGIN LUSTRE 60', 'LAMINASI DINGIN LUSTRE 90', 'LAMINASI DINGIN LUSTRE 125', 'LAMINASI DINGIN LUSTRE 310', 'LAMINASI PANAS GLOSSY 250', 'LAMINASI PANAS MATT 250', 'STIKER COKLAT A3+', 'STIKER DOFF A3+', 'STIKER GLOSSY A3+'];
                } else if (division === 'OUTDOOR') {
                    items = ['FLEXI CINA 340 GR', 'FLEXI CINA 440 GR', 'FLEXI CINA 510 GR', 'FLEXI CINA 610 GR', 'FLEXI KOREA 280 GR', 'FLEXI KOREA 320 GR', 'FLEXI KOREA 340 GR', 'FLEXI KOREA 440 GR', 'FLEXI KOREA 510 GR', 'FLEXI KOREA 610 GR', 'FLEXI KOREA 650 GR', 'FLEXI KOREA 730 GR', 'ONE WAY VISION', 'STIKER VINYL GLOSSY', 'STIKER VINYL LAMINASI', 'STIKER VINYL MATT'];
                } else if (division === 'PRODUKSI') {
                    items = ['ALUMUNIUM 0.2', 'ALUMUNIUM 0.3', 'ALUMUNIUM 0.4', 'ALUMUNIUM 0.5', 'ALUMUNIUM 0.8', 'ALUMUNIUM 1.0', 'ALUMUNIUM 2.0', 'ALUMUNIUM 3.0', 'STAINLESS 0.2', 'STAINLESS 0.3', 'STAINLESS 0.4', 'STAINLESS 0.5', 'STAINLESS 0.8', 'STAINLESS 1.0', 'STAINLESS 2.0', 'STAINLESS 3.0', 'STAINLESS 5.0', 'STAINLESS 6.0', 'STAINLESS 8.0', 'STAINLESS 10.0', 'PLAT BESI 0.2', 'PLAT BESI 0.3', 'PLAT BESI 0.4', 'PLAT BESI 0.5', 'PLAT BESI 0.8', 'PLAT BESI 1.0', 'PLAT BESi 2.0', 'PLAT BESI 3.0', 'PLAT BESI 5.0', 'PLAT BESI 6.0', 'PLAT BESI 8.0', 'PLAT BESI 10.0', 'PLAT BESI 12.0', 'PLAT BESI 15.0', 'PLAT BESI 20.0', 'PLAT BESI 25.0'];
                } else if (division === 'GUDANG') {
                    items = ['LAMPIRAN FOTO'];
                } else if (division === 'PURCHASE ORDER') {
                    items = ['PAPER A3', 'PAPER A4', 'PAPER A5', 'PAPER B1', 'PAPER B2'];
                }

                items.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.text = item;
                    itemNameSelect.appendChild(option);
                });
            }
        }

        function updateTableHeader() {
            const division = document.getElementById('division').value;
            const tableHead = document.getElementById('tableHead');

            let headers = '';
            if (division === 'DAILY JOB') {
                headers = `
                    <tr>
                        <th>No</th>
                        <th>Kegiatan</th>
                        <th>Start Date</th>
                        <th>Target Date</th>
                        <th>Finish Date</th>
                        <th>Catatan Progress</th>
                        <th>Action</th>
                    </tr>`;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                headers = `
                    <tr>
                        <th>No</th>
                        <th>Nama Barang</th>
                        <th>Tanggal</th>
                        <th>Banyaknya</th>
                        <th>Status Proses</th>
                        <th>Action</th>
                    </tr>`;
            } else {
                headers = `
                    <tr>
                        <th>No</th>
                        <th>Tanggal</th>
                        <th>Nama Barang</th>
                        <th>Jenis</th>
                        <th>Banyaknya</th>
                        <th>Catatan</th>
                        <th>Action</th>
                    </tr>`;
            }

            tableHead.innerHTML = headers;
        }

        function addData() {
            const division = document.getElementById('division').value;
            let row = {};

            if (division === 'DAILY JOB') {
                row = {
                    activity: document.getElementById('activity').value,
                    startDate: document.getElementById('startDate').value,
                    targetDate: document.getElementById('targetDate').value,
                    finishDate: document.getElementById('finishDate').value,
                    progressNotes: document.getElementById('progressNotes').value
                };
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                row = {
                    itemName: document.getElementById('opbItemName').value,
                    date: document.getElementById('opbDate').value,
                    quantity: document.getElementById('opbQuantity').value,
                    status: document.getElementById('opbStatus').value
                };
            } else {
                row = {
                    date: document.getElementById('date').value,
                    itemName: document.getElementById('itemNameSelect').value || document.getElementById('itemNameInput').value,
                    type: document.getElementById('type').value,
                    quantity: document.getElementById('quantity').value,
                    notes: document.getElementById('notes').value
                };
            }

            data.push(row);
            updateTable();
        }

        function updateTable() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            data.forEach((row, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${row.date || ''}</td>
                    <td>${row.itemName || row.activity || ''}</td>
                    <td>${row.type || row.startDate || ''}</td>
                    <td>${row.quantity || row.targetDate || ''}</td>
                    <td>${row.notes || row.finishDate || ''}</td>
                    <td>${row.status || row.progressNotes || ''}</td>
                    <td>
                        <div class="action-buttons">
                            <button onclick="editData(${index})">Edit</button>
                            <button onclick="deleteData(${index})">Delete</button>
                        </div>
                    </td>
                `;
                tableBody.appendChild(tr);
            });
        }

        function editData(index) {
            const row = data[index];
            const division = document.getElementById('division').value;

            if (division === 'DAILY JOB') {
                document.getElementById('activity').value = row.activity;
                document.getElementById('startDate').value = row.startDate;
                document.getElementById('targetDate').value = row.targetDate;
                document.getElementById('finishDate').value = row.finishDate;
                document.getElementById('progressNotes').value = row.progressNotes;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                document.getElementById('opbItemName').value = row.itemName;
                document.getElementById('opbDate').value = row.date;
                document.getElementById('opbQuantity').value = row.quantity;
                document.getElementById('opbStatus').value = row.status;
            } else {
                document.getElementById('date').value = row.date;
                document.getElementById('itemNameSelect').value = row.itemName;
                document.getElementById('type').value = row.type;
                document.getElementById('quantity').value = row.quantity;
                document.getElementById('notes').value = row.notes;
            }

            deleteData(index);
        }

        function deleteData(index) {
            data.splice(index, 1);
            updateTable();
        }

        function saveToExcel() {
            const table = document.querySelector('table');
            const wb = XLSX.utils.table_to_book(table, {sheet: 'Sheet1'});
            XLSX.writeFile(wb, 'data.xlsx');
        }

        document.addEventListener('DOMContentLoaded', function () {
            updateForm();
        });
    </script>
</body>
</html>
