<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock Barang</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        form button:hover {
            background-color: #218838;
        }

        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table thead {
            background-color: #007bff;
            color: white;
        }

        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: #007bff;
            color: white;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-button {
            background-color: #ffc107;
            color: white;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: white;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Laporan Stock Barang</h1>
    <form id="dataForm">
        <label for="division">Divisi:</label>
        <select id="division" name="division" required onchange="updateItemNames()">
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" required>
        <label for="itemName">Nama Barang:</label>
        <select id="itemName" name="itemName" required>
            <!-- Options will be populated based on division selection -->
        </select>
        <label for="type">Jenis:</label>
        <select id="type" name="type" required>
            <option value="Material Masuk">Material Masuk</option>
            <option value="Material Terpakai">Material Terpakai</option>
            <option value="Material Reject">Material Reject</option>
            <option value="Potongan Reject">Potongan Reject</option>
        </select>
        <label for="quantity">Banyaknya:</label>
        <input type="number" id="quantity" name="quantity" required>
        <label for="notes">Catatan:</label>
        <input type="text" id="notes" name="notes">
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Preview</h2>
    <div id="preview">
        <table>
            <thead>
                <tr>
                    <th>Divisi</th>
                    <th>Date</th>
                    <th>Nama Barang</th>
                    <th>Jenis</th>
                    <th>Banyaknya</th>
                    <th>Catatan</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script>
        const data = [];

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemName');
            itemNameSelect.innerHTML = ''; // Clear previous options

            let items = [];
            if (division === 'INDOOR') {
                items = ['DOKU TONER BLACK', 'DOKU TONER CYAN', 'DOKU TONER MAGENTA', 'DOKU TONER YELLOW', 'KERTAS ARTCARTON / BW A3+', 'KERTAS ARTPAPER A3+', 'KERTAS BRIEF CARD / BC F4', 'KERTAS BUFALO BIRU', 'KERTAS BUFALO HIJAU', 'KERTAS BUFALO KUNING', 'KERTAS BUFALO MERAH', 'KERTAS BUFALO ORANGE', 'KERTAS BUFALO PINK', 'KERTAS BUFALO PUTIH', 'KERTAS BUFALO SKY BLUE', 'KERTAS BUFALO UNGU', 'KERTAS FOTO', 'KERTAS HVS A3 PUTIH', 'KERTAS HVS A3+ PUTIH', 'KERTAS HVS A4 PUTIH', 'KERTAS HVS F4 BIRU', 'KERTAS HVS F4 HIJAU', 'KERTAS HVS F4 KUNING', 'KERTAS HVS F4 MERAH', 'KERTAS HVS F4 PUTIH', 'KERTAS INJECT', 'KERTAS KALKIR', 'KERTAS LINEN A3', 'KERTAS LINEN A4', 'KERTAS NCR BIRU', 'KERTAS NCR HIJAU', 'KERTAS NCR KUNING', 'KERTAS NCR MERAH', 'KERTAS NCR PUTIH', 'KERTAS SUBLIME A4', 'MASKING STIKER 10 CM', 'MASKING STIKER 15 CM', 'PVC ID CARD', 'STIKER CROMO A3+', 'STIKER HOLOGRAM A3+', 'STIKER POLIFLEX GOLD', 'STIKER POLIFLEX HITAM', 'STIKER POLIFLEX PUTIH', 'STIKER SKOTLET BIRU', 'STIKER SKOTLET GOLD', 'STIKER SKOTLET HIJAU', 'STIKER SKOTLET HITAM', 'STIKER SKOTLET KUNING', 'STIKER SKOTLET MERAH', 'STIKER SKOTLET ORANGE', 'STIKER SKOTLET PUTIH', 'STIKER SKOTLET SILVER', 'STIKER TRANSPARANT A3+', 'STIKER VINYL A3+', 'TINTA DIAMOND ART BIRU', 'TINTA DIAMOND ART HITAM', 'TINTA DIAMOND ART KUNING', 'TINTA DIAMOND ART MERAH', 'TRANSFER PAPER / OPACK'];
            } else if (division === 'OUTDOOR') {
                items = ['ECO SOLVEN', 'FLEXY CHINA 300 GR', 'FLEXY CHINA 340 GR', 'KOREA CHINA 440 GR', 'LEM HANDSOME', 'MATIK', 'STAND ROLL UP BANNER', 'STAND Y-BANNER', 'STIKER ONE WAY', 'STIKER TRANSPARANT', 'STIKER VINYL METER', 'TINTA BLACK / HITAM', 'TINTA CYAN / BIRU', 'TINTA RED / MERAH', 'TINTA YELLOW / KUNING', 'TISU KEPING', 'Y BANNER MINI A3', 'FLEXY CHINA 280 GR'];
            } else if (division === 'PRODUKSI') {
                items = ['CAT KARUNG HIJAU', 'CAT KARUNG HITAM', 'CAT KARUNG KUNING', 'CAT KARUNG MERAH', 'Cat Plastisol Hitam', 'CAT PLASTISOL KUNING', 'Cat Plastisol Merah', 'CAT PLASTISOL PUTIH', 'kain asahi', 'Kain Milano Hitam', 'Kain Milano Putih', 'Karung Mulyana Polos 25 Kg', 'Karung Mulyana Polos 50 Kg', 'M4', 'PLASTIK JERSEY', 'PLASTIK KAOS', 'SUMO 50 Kg Transparant', 'SUMO 25 Kg Transparant', 'HOKI 50 Kg Doff Putih', 'HOKI 25 Kg Doff Putih', 'PILOT 50 Kg Transparant', 'PILOT 25 Kg Transparant', 'PILOT 10 Kg Transparant', 'KEPALA SINGA 50 Kg Transparant', 'KTI 50 Kg Transparant', 'KTI 25 Kg Transparant', 'MERCUSUAR 50 Doff Putih', 'MERCURUAS 25 Doff Putih', 'KARUNG 110x150 Doff Putih Garis Biru'];
            } else if (division === 'GUDANG') {
                items = ['Akrilik Name Tag', 'Box Kartu Nama', 'CUTTING MAT A3', 'CUTTING MAT A4', 'DUS MUG', 'GANCI PIN 44mm', 'GANCI PIN 58mm', 'GUNTING', 'Hanger', 'KANTONG PELASTIK BESAR', 'KANTONG PELASTIK SEDANG', 'Karet Stempel Flash', 'KARTON', 'KATER', 'Kawat Spiral 03 = 4 - 6 Lembar', 'Kawat Spiral 04 = 7 - 10 Lembar', 'Kawat Spiral 05 = 11 - 20 Lembar', 'Kawat Spiral 06 = 21 - 35 Lembar', 'Kawat Spiral 07 = 36 - 60 Lembar', 'Kawat Spiral 08 = 61 - 90 Lembar', 'Kawat Spiral 09 = 91 - 125 Lembar', 'Kawat Spiral 10 = 126 - 150 Lembar', 'Kawat Spiral 11 = 151 -175 Lembar', 'Kawat Spiral 12 = 176 - 225 Lembar', 'KERTAS SAMSON', 'Klem Kalender', 'LAKBAN KERTAS', 'LAKBAN UK.1 CM', 'LAKBAN UK.2,5 cm', 'LAKBAN UK.5 CM', 'Laminasy Doff A3', 'Laminasy Glossy A3', 'Laminatin A4', 'Laminatin F4', 'Lanyard', 'MASKER', 'MIKA', 'MUG', 'PENGHAPUS PUTIH', 'Peniti Name Tag', 'PIN 44mm', 'PIN 58mm', 'PIN Magnet 44mm', 'PIN Magnet 58mm', 'PLASTIK SLONGSONG 11 CM', 'Sempel CBO45', 'Stampel IT6018', 'Stempel CB0V35', 'Stempel CB0V45', 'Stempel CB0V51', 'Stempel CB1035', 'STEMPEL CB1340', 'Stempel CB1755', 'Stempel CB2255', 'Stempel CB2755', 'Stempel CB4040', 'Stempel CB4355', 'Stempel CB4367', 'Stempel CB4378', 'Stempel CBO17', 'Stempel CBO25', 'Stempel CBO28', 'Stempel CBO32', 'Stempel CBO35', 'Stempel CBO40', 'Stempel CBO45', 'Stempel IT3313', 'Stempel IT4515', 'Stiker Yupo', 'TALI RAPIAH ', 'Tinta Stampel Biru', 'Tinta Stampel Hijau', 'Tinta Stampel Hitam', 'Tinta Stampel Kuning', 'Tinta Stampel Merah', 'Tinta Stampel Orange', 'Tinta Stampel Ungu', 'TISU', 'Yoyo ID Card', 'MENDALI BULAT,SEGITIGA'
			];
            }

            items.forEach(item => {
                const option = document.createElement('option');
                option.value = item;
                option.textContent = item;
                itemNameSelect.appendChild(option);
            });
        }

        function addData() {
            const division = document.getElementById('division').value;
            const date = document.getElementById('date').value;
            const itemName = document.getElementById('itemName').value;
            const type = document.getElementById('type').value;
            const quantity = document.getElementById('quantity').value;
            const notes = document.getElementById('notes').value;
            if (division && date && itemName && type && quantity) {
                data.push({ division, date, itemName, type, quantity, notes });
                updatePreview();
                clearForm();
            }
        }

        function clearForm() {
            document.getElementById('division').value = '';
            updateItemNames(); // Update item names after clearing division
            document.getElementById('date').value = '';
            document.getElementById('itemName').value = '';
            document.getElementById('type').value = '';
            document.getElementById('quantity').value = '';
            document.getElementById('notes').value = '';
        }

        function updatePreview() {
            const previewTable = document.querySelector('#preview tbody');
            previewTable.innerHTML = '';
            data.forEach((item, index) => {
                const row = previewTable.insertRow();
                const divisionCell = row.insertCell(0);
                const dateCell = row.insertCell(1);
                const itemNameCell = row.insertCell(2);
                const typeCell = row.insertCell(3);
                const quantityCell = row.insertCell(4);
                const notesCell = row.insertCell(5);
                const actionCell = row.insertCell(6);

                divisionCell.textContent = item.division;
                dateCell.textContent = item.date;
                itemNameCell.textContent = item.itemName;
                typeCell.textContent = item.type;
                quantityCell.textContent = item.quantity;
                notesCell.textContent = item.notes;

                const editButton = document.createElement('button');
                editButton.textContent = 'Ubah';
                editButton.className = 'edit-button';
                editButton.onclick = () => editData(index);

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Hapus';
                deleteButton.className = 'delete-button';
                deleteButton.onclick = () => deleteData(index);

                actionCell.appendChild(editButton);
                actionCell.appendChild(deleteButton);
                actionCell.className = 'action-buttons';
            });
        }

        function editData(index) {
            const item = data[index];
            document.getElementById('division').value = item.division;
            updateItemNames(); // Update item names based on selected division
            document.getElementById('itemName').value = item.itemName;
            document.getElementById('date').value = item.date;
            document.getElementById('type').value = item.type;
            document.getElementById('quantity').value = item.quantity;
            document.getElementById('notes').value = item.notes;
            data.splice(index, 1);
            updatePreview();
        }

        function deleteData(index) {
            data.splice(index, 1);
            updatePreview();
        }

        function saveToExcel() {
            const table = document.querySelector('#preview table');
            const workbook = XLSX.utils.table_to_book(table);
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0]; // Format YYYY-MM-DD
            const fileName = `Data_${formattedDate}.xlsx`;
            XLSX.writeFile(workbook, fileName);
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</body>
</html>
