<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Stock</title>
    <style>
              body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
        }

        h1, h2 {
            text-align: center;
            color: #333;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        form input, form select {
            width: calc(100% - 20px);
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        form button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        form button:hover {
            background-color: #218838;
        }

        #preview {
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table thead {
            background-color: #007bff;
            color: white;
        }

        table th, table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: #007bff;
            color: white;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        .action-buttons button {
            margin-right: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-button {
            background-color: #ffc107;
            color: white;
        }

        .edit-button:hover {
            background-color: #e0a800;
        }

        .delete-button {
            background-color: #dc3545;
            color: white;
        }

        .delete-button:hover {
            background-color: #c82333;
        }

        #saveButton {
            display: block;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }

        #saveButton:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Input Data</h1>
    <form id="dataForm">
        <label for="division">Divisi:</label>
        <select id="division" name="division" required onchange="updateForm()">
            <option value="">-- Pilih Divisi --</option>
            <option value="INDOOR">INDOOR</option>
            <option value="OUTDOOR">OUTDOOR</option>
            <option value="PRODUKSI">PRODUKSI</option>
            <option value="GUDANG">GUDANG</option>
            <option value="PURCHASE ORDER">PURCHASE ORDER</option>
            <option value="DAILY JOB">DAILY JOB</option>
            <option value="ORDER PERMINTAAN BARANG">ORDER PERMINTAAN BARANG</option>
        </select>
        <div id="commonFields">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date">
            <label for="itemName">Nama Barang:</label>
            <div id="itemNameContainer">
                <select id="itemNameSelect" name="itemName">
                    <!-- Options will be populated based on division selection -->
                </select>
                <input type="text" id="itemNameInput" name="itemName" style="display: none;">
            </div>
            <label for="quantity">Banyaknya:</label>
            <input type="number" id="quantity" name="quantity">
            <label for="notes">Catatan:</label>
            <input type="text" id="notes" name="notes">
            <div id="jenisField" style="display: block;">
                <label for="type">Jenis:</label>
                <select id="type" name="type">
                    <option value="Material Masuk">Material Masuk</option>
                    <option value="Material Terpakai">Material Terpakai</option>
                    <option value="Material Reject">Material Reject</option>
                    <option value="Potongan Reject">Potongan Reject</option>
                </select>
            </div>
        </div>
        <div id="dailyJobFields" style="display: none;">
            <label for="activity">Kegiatan:</label>
            <input type="text" id="activity" name="activity">
            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate">
            <label for="targetDate">Target Date:</label>
            <input type="date" id="targetDate" name="targetDate">
            <label for="finishDate">Finish Date:</label>
            <input type="date" id="finishDate" name="finishDate">
            <label for="progressNotes">Catatan Progress:</label>
            <input type="text" id="progressNotes" name="progressNotes">
        </div>
        <button type="button" onclick="addData()">Add Data</button>
    </form>

    <h2>Preview</h2>
    <div id="preview">
        <table>
            <thead id="tableHead">
                <!-- Table headers will be populated based on division selection -->
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <button id="saveButton" onclick="saveToExcel()">Save to Excel</button>

    <script>
        const data = [];

        function updateForm() {
            const division = document.getElementById('division').value;
            const commonFields = document.getElementById('commonFields');
            const dailyJobFields = document.getElementById('dailyJobFields');
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');
            const jenisField = document.getElementById('jenisField');

            if (division === 'DAILY JOB') {
                commonFields.style.display = 'none';
                dailyJobFields.style.display = 'block';
                itemNameInput.required = false;
                itemNameSelect.required = false;
                jenisField.style.display = 'none';
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                jenisField.style.display = 'none';
                updateItemNames();
            } else {
                commonFields.style.display = 'block';
                dailyJobFields.style.display = 'none';
                itemNameInput.required = true;
                itemNameSelect.required = true;
                jenisField.style.display = 'block';
                updateItemNames();
            }

            updateTableHeader();
        }

        function updateItemNames() {
            const division = document.getElementById('division').value;
            const itemNameSelect = document.getElementById('itemNameSelect');
            const itemNameInput = document.getElementById('itemNameInput');
            
            if (division === 'DAILY JOB') {
                itemNameSelect.style.display = 'none';
                itemNameInput.style.display = 'block';
            } else {
                itemNameSelect.style.display = 'block';
                itemNameInput.style.display = 'none';
                itemNameSelect.innerHTML = '<option value="">-- Pilih Nama Barang --</option>';
                let items = [];
                if (division === 'INDOOR') {
                    items = ['DOKU TONER BLACK', 'DOKU TONER CYAN', 'DOKU TONER MAGENTA', 'DOKU TONER YELLOW', 'KERTAS ARTCARTON / BW A3+', 'KERTAS ARTPAPER A3+', 'KERTAS BRIEF CARD / BC F4', 'KERTAS BUFALO BIRU', 'KERTAS BUFALO HIJAU', 'KERTAS BUFALO KUNING', 'KERTAS BUFALO MERAH', 'KERTAS BUFALO ORANGE', 'KERTAS BUFALO PINK', 'KERTAS BUFALO PUTIH', 'KERTAS BUFALO SKY BLUE', 'KERTAS BUFALO UNGU', 'KERTAS FOTO', 'KERTAS HVS A3 PUTIH', 'KERTAS HVS A3+ PUTIH', 'KERTAS HVS A4 PUTIH', 'KERTAS HVS F4 BIRU', 'KERTAS HVS F4 HIJAU', 'KERTAS HVS F4 KUNING', 'KERTAS HVS F4 MERAH', 'KERTAS HVS F4 PUTIH', 'KERTAS INJECT', 'KERTAS KALKIR', 'KERTAS LINEN A3', 'KERTAS LINEN A4', 'KERTAS NCR BIRU', 'KERTAS NCR HIJAU', 'KERTAS NCR KUNING', 'KERTAS NCR MERAH', 'KERTAS NCR PUTIH', 'KERTAS SUBLIME A4', 'MASKING STIKER 10 CM', 'MASKING STIKER 15 CM', 'PVC ID CARD', 'STIKER CROMO A3+', 'STIKER HOLOGRAM A3+', 'STIKER POLIFLEX GOLD', 'STIKER POLIFLEX HITAM', 'STIKER POLIFLEX PUTIH', 'STIKER SKOTLET BIRU', 'STIKER SKOTLET GOLD', 'STIKER SKOTLET HIJAU', 'STIKER SKOTLET HITAM', 'STIKER SKOTLET KUNING', 'STIKER SKOTLET MERAH', 'STIKER SKOTLET ORANGE', 'STIKER SKOTLET PUTIH', 'STIKER SKOTLET SILVER', 'STIKER TRANSPARANT A3+', 'STIKER VINYL A3+', 'TINTA DIAMOND ART BIRU', 'TINTA DIAMOND ART HITAM', 'TINTA DIAMOND ART KUNING', 'TINTA DIAMOND ART MAGENTA', 'TINTA DIAMOND ART CYAN', 'TINTA DIAMOND DIGITAL BIRU', 'TINTA DIAMOND DIGITAL HITAM', 'TINTA DIAMOND DIGITAL KUNING', 'TINTA DIAMOND DIGITAL MAGENTA', 'TINTA DIAMOND DIGITAL CYAN', 'TINTA DIAMOND SUBLIM BIRU', 'TINTA DIAMOND SUBLIM HITAM', 'TINTA DIAMOND SUBLIM KUNING', 'TINTA DIAMOND SUBLIM MAGENTA', 'TINTA DIAMOND SUBLIM CYAN', 'TINTA EPSON L100 BIRU', 'TINTA EPSON L100 HITAM', 'TINTA EPSON L100 KUNING', 'TINTA EPSON L100 MAGENTA', 'TINTA EPSON L100 CYAN', 'TINTA EPSON L200 BIRU', 'TINTA EPSON L200 HITAM', 'TINTA EPSON L200 KUNING', 'TINTA EPSON L200 MAGENTA', 'TINTA EPSON L200 CYAN', 'TINTA EPSON L800 BIRU', 'TINTA EPSON L800 HITAM', 'TINTA EPSON L800 KUNING', 'TINTA EPSON L800 MAGENTA', 'TINTA EPSON L800 CYAN', 'TINTA EPSON L805 BIRU', 'TINTA EPSON L805 HITAM', 'TINTA EPSON L805 KUNING', 'TINTA EPSON L805 MAGENTA', 'TINTA EPSON L805 CYAN'];
                } else if (division === 'OUTDOOR') {
                    items = ['BANER FLEXI', 'BANER TENT', 'STIKER VINYL BIRU', 'STIKER VINYL HITAM', 'STIKER VINYL KUNING', 'STIKER VINYL MAGENTA', 'STIKER VINYL MERAH', 'STIKER VINYL PUTIH', 'STIKER VINYL TRANSPARANT'];
                } else if (division === 'PRODUKSI') {
                    items = ['PRODUKSI BANNER', 'PRODUKSI STIKER', 'PRODUKSI KALENDER'];
                }
                items.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.textContent = item;
                    itemNameSelect.appendChild(option);
                });
            }
        }

        function updateTableHeader() {
            const division = document.getElementById('division').value;
            const tableHead = document.getElementById('tableHead');
            tableHead.innerHTML = '';

            if (division === 'DAILY JOB') {
                tableHead.innerHTML = `
                    <tr>
                        <th>Division</th>
                        <th>Date</th>
                        <th>Activity</th>
                        <th>Start Date</th>
                        <th>Target Date</th>
                        <th>Finish Date</th>
                        <th>Progress Notes</th>
                    </tr>
                `;
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                tableHead.innerHTML = `
                    <tr>
                        <th>Division</th>
                        <th>Date</th>
                        <th>Nama Barang</th>
                        <th>Banyaknya</th>
                        <th>Catatan</th>
                    </tr>
                `;
            } else {
                tableHead.innerHTML = `
                    <tr>
                        <th>Division</th>
                        <th>Date</th>
                        <th>Nama Barang</th>
                        <th>Banyaknya</th>
                        <th>Jenis</th>
                        <th>Catatan</th>
                    </tr>
                `;
            }
        }

        function addData() {
            const division = document.getElementById('division').value;
            const date = document.getElementById('date').value;
            const itemName = document.getElementById('itemNameSelect').style.display === 'none' ? document.getElementById('itemNameInput').value : document.getElementById('itemNameSelect').value;
            const quantity = document.getElementById('quantity').value;
            const notes = document.getElementById('notes').value;
            const activity = document.getElementById('activity') ? document.getElementById('activity').value : '';
            const startDate = document.getElementById('startDate') ? document.getElementById('startDate').value : '';
            const targetDate = document.getElementById('targetDate') ? document.getElementById('targetDate').value : '';
            const finishDate = document.getElementById('finishDate') ? document.getElementById('finishDate').value : '';
            const progressNotes = document.getElementById('progressNotes') ? document.getElementById('progressNotes').value : '';
            const type = document.getElementById('type') ? document.getElementById('type').value : '';

            if (division === 'DAILY JOB') {
                if (!activity || !startDate || !targetDate || !finishDate || !progressNotes) {
                    alert('Please fill in all fields.');
                    return;
                }
                data.push([division, date, activity, startDate, targetDate, finishDate, progressNotes]);
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                if (!itemName || !quantity) {
                    alert('Please fill in all fields.');
                    return;
                }
                data.push([division, date, itemName, quantity, notes]);
            } else {
                if (!itemName || !quantity || !type) {
                    alert('Please fill in all fields.');
                    return;
                }
                data.push([division, date, itemName, quantity, type, notes]);
            }

            updateTable();
        }

        function updateTable() {
            const tableBody = document.querySelector('#preview tbody');
            tableBody.innerHTML = '';
            data.forEach(row => {
                const tr = document.createElement('tr');
                row.forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tableBody.appendChild(tr);
            });
        }

        function saveToExcel() {
            let csvContent = "data:text/csv;charset=utf-8,";

            // Create header row
            const division = document.getElementById('division').value;
            if (division === 'DAILY JOB') {
                csvContent += "Division,Date,Activity,Start Date,Target Date,Finish Date,Progress Notes\n";
            } else if (division === 'ORDER PERMINTAAN BARANG') {
                csvContent += "Division,Date,Nama Barang,Banyaknya,Catatan\n";
            } else {
                csvContent += "Division,Date,Nama Barang,Banyaknya,Jenis,Catatan\n";
            }

            // Append data rows
            data.forEach(row => {
                csvContent += row.join(",") + "\n";
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "data_report.csv");
            document.body.appendChild(link);
            link.click();
        }
    </script>
</body>
</html>
